(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a393a5a"],{"0970":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",{staticClass:"depart"},[s("div",[s("div",{staticClass:"top"},[s("el-button",{staticClass:"btn",on:{click:function(t){return e.addDialogShow()}}},[s("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" "+e._s(e.$t("views.userList.addUser"))+" ")]),s("el-input",{staticClass:"ipt",attrs:{placeholder:e.$t("views.userList.keywordPlaceholder")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.newSelectData.apply(null,arguments)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),s("div",{staticClass:"bottom"},[s("el-table",{staticClass:"depart-table",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[s("el-table-column",{attrs:{"min-width":"200",prop:"username",label:e.$t("views.userList.name")}}),s("el-table-column",{attrs:{prop:"email",label:e.$t("views.userList.email"),width:"180"}}),s("el-table-column",{attrs:{prop:"is_superuser",label:e.$t("views.userList.role"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(" "+e._s(0===s.is_superuser?e.$t("views.userList.user"):e.$t("views.userList.admin"))+" ")]}}])}),s("el-table-column",{attrs:{prop:"department.name",label:e.$t("views.userList.department"),width:"180"}}),s("el-table-column",{attrs:{prop:"phone",label:e.$t("views.userList.phone"),width:"180"}}),s("el-table-column",{attrs:{label:e.$t("views.userList.operate"),"min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[1===e.$store.getters.userInfo.role||2===e.$store.getters.userInfo.role?s("i",{staticClass:"iconfont iconzhongzhimima pIcon",on:{click:function(t){return e.resetPwd(r)}}}):e._e(),s("i",{staticClass:"iconfont iconshezhi-2 pIcon",on:{click:function(t){return e.userEdit(r)}}}),s("i",{staticClass:"iconfont iconshanchu-6 pIcon",on:{click:function(t){return e.userDelete(r.id)}}})]}}])})],1),s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{"current-page":e.page,"page-size":10,layout:"total,prev,pager,next,jumper",total:e.allTotal},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.handleCurrentChange}})],1)],1)]),e.addDialogOpen?s("el-dialog",{attrs:{visible:e.addDialogOpen,top:"8vh",title:e.isAdd?e.$t("views.userList.addUser"):e.$t("views.userList.editUser")},on:{"update:visible":function(t){e.addDialogOpen=t}}},[s("el-form",{ref:"ruleForm",attrs:{"label-width":"150px",model:e.userForm,"status-icon":"",rules:e.rules}},[s("el-form-item",{attrs:{label:e.$t("views.userList.name"),prop:"username"}},[s("el-input",{staticClass:"addUserInput",staticStyle:{width:"400px"},attrs:{placeholder:e.$t("views.userList.namePlaceholder"),disabled:!e.isAdd,clearable:"",size:"small"},model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),s("el-form-item",{attrs:{label:e.$t("views.userList.email"),prop:"email"}},[s("el-input",{staticClass:"addUserInput",staticStyle:{width:"400px"},attrs:{placeholder:e.$t("views.userList.email"),clearable:"",size:"small"},model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email",t)},expression:"userForm.email"}})],1),s("el-form-item",{attrs:{label:e.$t("views.userList.role")}},[s("el-select",{staticClass:"addUserInput",staticStyle:{width:"400px"},attrs:{clearable:"",size:"small"},model:{value:e.userForm.role,callback:function(t){e.$set(e.userForm,"role",t)},expression:"userForm.role"}},[s("el-option",{attrs:{label:e.$t("views.userList.admin"),value:2}}),s("el-option",{attrs:{label:e.$t("views.userList.user"),value:0}})],1)],1),s("el-form-item",{attrs:{label:e.$t("views.userList.department")}},[s("el-cascader",{staticClass:"addUserInput",staticStyle:{width:"400px"},attrs:{props:{checkStrictly:!0,value:"id",emitPath:!1},options:e.options,placeholder:e.$t("views.userList.department"),size:"small",clearable:""},model:{value:e.userForm.department,callback:function(t){e.$set(e.userForm,"department",t)},expression:"userForm.department"}})],1),s("el-form-item",{attrs:{label:e.$t("views.userList.phone"),prop:"phone"}},[s("el-input",{staticClass:"addUserInput",staticStyle:{width:"400px"},attrs:{placeholder:e.$t("views.userList.phonePlaceholder"),clearable:"",size:"small"},model:{value:e.userForm.phone,callback:function(t){e.$set(e.userForm,"phone",t)},expression:"userForm.phone"}})],1),e.userForm.uid?e._e():s("el-form-item",{attrs:{label:e.$t("views.userList.password"),prop:"password"}},[s("el-input",{staticClass:"addUserInput",staticStyle:{width:"400px"},attrs:{"show-password":"",placeholder:e.$t("views.userList.passwordPlaceholder"),clearable:"",size:"small"},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1),e.userForm.uid?s("el-form-item",{attrs:{label:e.$t("views.userList.password")}},[s("el-input",{staticClass:"addUserInput",staticStyle:{width:"400px"},attrs:{"show-password":"",placeholder:e.$t("views.userList.passwordPlaceholder"),clearable:"",size:"small"},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1):e._e(),e.userForm.uid?e._e():s("el-form-item",{attrs:{label:e.$t("views.userList.rePass"),prop:"re_password"}},[s("el-input",{staticClass:"addUserInput",staticStyle:{width:"400px"},attrs:{"show-password":"",placeholder:e.$t("views.userList.rePassPlaceholder"),clearable:"",size:"small"},model:{value:e.userForm.re_password,callback:function(t){e.$set(e.userForm,"re_password",t)},expression:"userForm.re_password"}})],1),e.userForm.uid?s("el-form-item",{attrs:{label:e.$t("views.userList.rePass")}},[s("el-input",{staticClass:"addUserInput",staticStyle:{width:"400px"},attrs:{"show-password":"",placeholder:e.$t("views.userList.rePassPlaceholder"),clearable:"",size:"small"},model:{value:e.userForm.re_password,callback:function(t){e.$set(e.userForm,"re_password",t)},expression:"userForm.re_password"}})],1):e._e(),s("el-form-item",[s("el-button",{staticClass:"submitBtn",attrs:{type:"text",size:"small"},on:{click:e.userAdd}},[e._v(e._s(e.$t("views.userList.submit")))]),s("el-button",{staticClass:"cancelBtn",attrs:{type:"text",size:"small"},on:{click:e.cancelAdd}},[e._v(e._s(e.$t("views.userList.cancel")))])],1)],1)],1):e._e()],1)},a=[],i=s("1da1"),n=s("d4ec"),l=s("bee2"),o=s("262e"),u=s("2caf"),c=(s("96cf"),s("d9e2"),s("d3b7"),s("159b"),s("9ab4")),d=s("8c73"),p=s("60a3"),m=function(e){Object(o["a"])(s,e);var t=Object(u["a"])(s);function s(){var e;return Object(n["a"])(this,s),e=t.apply(this,arguments),e.addDialogOpen=!1,e.page=1,e.allTotal=0,e.isAdd=!0,e.options=[],e.keyword="",e.form={name:"",region:"",value:!0},e.rules={username:[{required:!0,message:e.$t("views.userList.namePlaceholder"),trigger:"blur"}],email:[{required:!0,message:e.$t("views.userList.emailPlaceholder"),trigger:"blur"}],phone:[{required:!0,message:e.$t("views.userList.phonePlaceholder"),trigger:"blur"}],password:[{validator:e.validateNewPass,trigger:"blur"}],re_password:[{validator:e.validateCheckPass,trigger:"blur"}]},e.tableData=[],e.userForm={username:"",password:"",re_password:"",email:"",role:0,department:"",phone:"",uid:0},e}return Object(l["a"])(s,[{key:"newSelectData",value:function(){this.page=1,this.getTableData()}},{key:"validateNewPass",value:function(e,t,s){""===t?s(new Error(this.$t("views.userList.needPWD"))):(""!==this.userForm.password&&this.$refs.ruleForm.validateField("re_password"),s())}},{key:"resetPwd",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$confirm(this.$t("views.userList.resetConfirm"),this.$t("views.userList.resetConfirmPop"),{confirmButtonText:this.$t("views.userList.submit"),cancelButtonText:this.$t("views.userList.cancel"),type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){var r,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s.services.user.reset({userId:t.id});case 2:r=e.sent,a=r.status,i=r.msg,201===a?s.$message({type:"success",message:i,showClose:!0}):s.$message({type:"error",message:i,showClose:!0});case 6:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"userDelete",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$confirm(this.$t("views.userList.deleteConfirm"),this.$t("views.userList.deleteConfirmPop"),{confirmButtonText:this.$t("views.userList.submit"),cancelButtonText:this.$t("views.userList.cancel"),type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){var r,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s.loadingStart(),e.next=3,s.services.user.userDelete({uid:t});case 3:if(r=e.sent,a=r.status,i=r.msg,s.loadingDone(),201===a){e.next=10;break}return s.$message({type:"error",message:i,showClose:!0}),e.abrupt("return");case 10:return s.$message({type:"success",message:i,showClose:!0}),e.next=13,s.getTableData();case 13:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"validateCheckPass",value:function(e,t,s){""===t?s(new Error(this.$t("views.userList.rePWD"))):t!==this.userForm.password?s(new Error(this.$t("views.userList.diffPWD"))):s()}},{key:"handleCurrentChange",value:function(e){this.page=e,this.getTableData()}},{key:"getTableData",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.user.userList({page:this.page,pageSize:10,keywords:this.keyword});case 3:t=e.sent,this.loadingDone(),201===t.status?(this.tableData=t.data,this.allTotal=t.page.alltotal):this.$message.error(t.msg);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"addDialogShow",value:function(){this.userForm={username:"",password:"",re_password:"",email:"",role:0,department:"",phone:"",uid:0},this.addDialogOpen=!0}},{key:"userEdit",value:function(e){this.isAdd=!1,this.userForm={username:e.username,password:"",re_password:"",email:e.email,role:e.is_superuser,department:e.department.id,phone:e.phone,uid:e.id},this.addDialogOpen=!0}},{key:"cancelAdd",value:function(){this.addDialogOpen=!1,!1===this.isAdd&&(this.isAdd=!0)}},{key:"userAdd",value:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(s){var r,a,i,n,l,o,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!s){t.next=31;break}if(r={username:e.userForm.username,password:e.userForm.password,re_password:e.userForm.re_password,email:e.userForm.email,role:e.userForm.role,department:e.userForm.department,phone:e.userForm.phone},e.userForm.uid&&(r.uid=e.userForm.uid),console.log(r),e.loadingStart(),!e.isAdd){t.next=17;break}return t.next=8,e.services.user.userAdd(r);case 8:if(a=t.sent,i=a.status,n=a.msg,e.loadingDone(),201===i){t.next=15;break}return e.$message({type:"error",message:n,showClose:!0}),t.abrupt("return");case 15:t.next=26;break;case 17:return t.next=19,e.services.user.userEdit(r);case 19:if(l=t.sent,o=l.status,u=l.msg,e.loadingDone(),201===o){t.next=26;break}return e.$message({type:"error",message:u,showClose:!0}),t.abrupt("return");case 26:e.addDialogOpen=!1,e.getTableData(),e.isAdd=!0,t.next=33;break;case 31:return console.log("error submit!!"),t.abrupt("return",!1);case 33:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"fmtOptions",value:function(e){var t=this;e.forEach((function(e){e.id<0&&(e.disabled=!0),e.value={name:e.label,id:e.id},e.children.length?t.fmtOptions(e.children):delete e.children}))}},{key:"departmentList",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.services.user.departmentList();case 2:t=e.sent,201===t.status&&(this.fmtOptions(t.data),this.options=t.data);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){this.getTableData(),this.departmentList()}}]),s}(d["a"]);m=Object(c["b"])([Object(p["a"])({name:"DepartmentList"})],m);var h=m,w=h,v=(s("89a2"),s("2877")),f=Object(v["a"])(w,r,a,!1,null,"a8e724ee",null);t["default"]=f.exports},"89a2":function(e,t,s){"use strict";s("f41a")},f41a:function(e,t,s){}}]);
//# sourceMappingURL=chunk-5a393a5a.ec7d33c9.js.map