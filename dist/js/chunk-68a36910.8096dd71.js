(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68a36910"],{"07ff":function(e,t,a){"use strict";a("0ed7")},"0ed7":function(e,t,a){},1276:function(e,t,a){"use strict";var r=a("d784"),n=a("44e7"),i=a("825a"),o=a("1d80"),l=a("4840"),s=a("8aa5"),u=a("50c4"),c=a("14c3"),h=a("9263"),p=a("d039"),f=[].push,g=Math.min,b=4294967295,d=!p((function(){return!RegExp(b,"y")}));r("split",2,(function(e,t,a){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,a){var r=String(o(this)),i=void 0===a?b:a>>>0;if(0===i)return[];if(void 0===e)return[r];if(!n(e))return t.call(r,e,i);var l,s,u,c=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,d=new RegExp(e.source,p+"g");while(l=h.call(d,r)){if(s=d.lastIndex,s>g&&(c.push(r.slice(g,l.index)),l.length>1&&l.index<r.length&&f.apply(c,l.slice(1)),u=l[0].length,g=s,c.length>=i))break;d.lastIndex===l.index&&d.lastIndex++}return g===r.length?!u&&d.test("")||c.push(""):c.push(r.slice(g)),c.length>i?c.slice(0,i):c}:"0".split(void 0,0).length?function(e,a){return void 0===e&&0===a?[]:t.call(this,e,a)}:t,[function(t,a){var n=o(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,n,a):r.call(String(n),t,a)},function(e,n){var o=a(r,e,this,n,r!==t);if(o.done)return o.value;var h=i(e),p=String(this),f=l(h,RegExp),m=h.unicode,v=(h.ignoreCase?"i":"")+(h.multiline?"m":"")+(h.unicode?"u":"")+(d?"y":"g"),k=new f(d?h:"^(?:"+h.source+")",v),y=void 0===n?b:n>>>0;if(0===y)return[];if(0===p.length)return null===c(k,p)?[p]:[];var _=0,x=0,w=[];while(x<p.length){k.lastIndex=d?x:0;var T,S=c(k,d?p:p.slice(x));if(null===S||(T=g(u(k.lastIndex+(d?0:x)),p.length))===_)x=s(p,x,m);else{if(w.push(p.slice(_,x)),w.length===y)return w;for(var O=1;O<=S.length-1;O++)if(w.push(S[O]),w.length===y)return w;x=_=T}}return w.push(p.slice(_)),w}]}),!d)},2909:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("6b75");function n(e){if(Array.isArray(e))return Object(r["a"])(e)}a("a4d3"),a("e01a"),a("d28b"),a("a630"),a("d3b7"),a("3ca3"),a("ddb0");function i(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var o=a("06c5");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e){return n(e)||i(e)||Object(o["a"])(e)||l()}},"55fe":function(e,t,a){},"7d19":function(e,t,a){"use strict";a("fda6")},"8b45":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"hook-rule"},[a("div",{staticClass:"top-info"},[a("div",{staticClass:"column"},[a("span",{staticClass:"top-title"},[e._v("规则总数")]),a("span",{staticClass:"bottom-info"},[e._v(e._s(e.base.ruleCount)+"条")])]),a("div",{staticClass:"column"},[a("span",{staticClass:"top-title"},[e._v("规则类型")]),a("span",{staticClass:"bottom-info"},[e._v(e._s(e.base.typeCount)+"种")])]),a("div",{staticClass:"column"},[a("span",{staticClass:"top-title"},[e._v("sink规则数量")]),a("span",{staticClass:"bottom-info"},[e._v(e._s(e.base.sinkCount)+"条")])])]),a("div",{staticClass:"info-body"},[a("el-tabs",{staticClass:"info-tabs",attrs:{type:"card"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[a("el-tab-pane",{staticClass:"info-tab",attrs:{label:"污点源方法规则",name:"2"}},["2"===e.type?a("HookTable",{attrs:{"rule-type":e.type}}):e._e()],1),a("el-tab-pane",{staticClass:"info-tab",attrs:{label:"传播方法规则",name:"1"}},["1"===e.type?a("HookTable",{attrs:{"rule-type":e.type}}):e._e()],1),a("el-tab-pane",{staticClass:"info-tab",attrs:{label:"过滤方法规则",name:"3"}},["3"===e.type?a("HookTable",{attrs:{"rule-type":e.type}}):e._e()],1),a("el-tab-pane",{staticClass:"info-tab",attrs:{label:"危险方法规则",name:"4"}},["4"===e.type?a("DangerTable",{attrs:{"rule-type":e.type}}):e._e()],1)],1)],1)])},n=[],i=(a("96cf"),a("1da1")),o=a("d4ec"),l=a("bee2"),s=a("262e"),u=a("2caf"),c=a("9ab4"),h=a("60a3"),p=a("8c73"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-body"},[a("div",{staticClass:"flex-right"},[a("el-button",{staticClass:"resetAllBtn",attrs:{size:"small"},on:{click:function(t){e.hookTypeDialog=!0}}},[e._v("添加规则类型")]),a("el-button",{staticClass:"resetAllBtn",attrs:{size:"small"},on:{click:function(t){e.hookDialog=!0}}},[e._v("添加规则")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"rule_type",label:"规则类型",width:"180"}}),a("el-table-column",{attrs:{prop:"value",label:"规则详情",width:"180"}}),a("el-table-column",{attrs:{prop:"source",label:"污点输入",width:"180"}}),a("el-table-column",{attrs:{prop:"inherit",label:"HOOK深度",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("true"===t.row.inherit?"子类":"all"===t.row.inherit?"当前类及子类":"当前类")+" ")]}}])}),a("el-table-column",{attrs:{prop:"track",label:"开启污点跟踪",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("true"===t.row.track?"是":"否")+" ")]}}])}),a("el-table-column",{attrs:{prop:"update_time",label:"修改时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatTimestamp")(t.row.update_time))+" ")]}}])}),a("el-table-column",{attrs:{prop:"user",label:"创建者",width:"180"}}),a("el-table-column",{attrs:{prop:"address",label:"操作",width:"360"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"启用","inactive-text":"禁用","active-value":1,"inactive-value":0},on:{change:function(a){return e.changeStatus(t.row)}},model:{value:t.row.enable,callback:function(a){e.$set(t.row,"enable",a)},expression:"scope.row.enable"}}),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"success",size:"small"},on:{click:function(a){return e.editRow(t.row)}}},[e._v(" 编辑 ")]),a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.row.visible,callback:function(a){e.$set(t.row,"visible",a)},expression:"scope.row.visible"}},[a("p",[e._v("确定删除吗？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.visible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.deleteRule(t.row)}}},[e._v("确定")])],1),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{slot:"reference",type:"danger",size:"small"},slot:"reference"},[e._v(" 删除 ")])],1)]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,background:"",layout:" prev, pager, next, jumper,total, sizes",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{visible:e.hookTypeDialog},on:{"update:visible":function(t){e.hookTypeDialog=t}}},[a("el-form",{attrs:{model:e.hookType,"label-width":"80px",size:"small"}},[a("el-form-item",{attrs:{label:"规则集"}},[a("span",[e._v(e._s(e.fmtType(e.hookType.type)))])]),a("el-form-item",{attrs:{label:"类型名称"}},[a("el-input",{attrs:{placeholder:"请输入类型名称，如：String、StringBuilder等，建议使用类名"},model:{value:e.hookType.name,callback:function(t){e.$set(e.hookType,"name",t)},expression:"hookType.name"}})],1),a("el-form-item",{attrs:{label:"类型简称"}},[a("el-input",{attrs:{placeholder:"请输入类型简称，如：字符串-01、字符串-02，方便自己查看"},model:{value:e.hookType.short_name,callback:function(t){e.$set(e.hookType,"short_name",t)},expression:"hookType.short_name"}})],1),a("el-form-item",{attrs:{label:"是否启用"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"启用","inactive-text":"禁用","active-value":1,"inactive-value":0},model:{value:e.hookType.enable,callback:function(t){e.$set(e.hookType,"enable",t)},expression:"hookType.enable"}})],1)],1),a("template",{slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.clearHookType}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.enterHookType}},[e._v("确定")])],1)],2),a("el-dialog",{attrs:{visible:e.hookDialog},on:{"update:visible":function(t){e.hookDialog=t}}},[a("el-form",{attrs:{model:e.hook,size:"small","label-width":"80px"}},[a("el-form-item",{attrs:{label:"规则集"}},[a("span",[e._v(e._s(e.fmtType(e.hook.type)))])]),a("el-form-item",{attrs:{label:"规则类型"}},[a("el-select",{attrs:{placeholder:"请选择规则类型"},model:{value:e.hook.rule_type_id,callback:function(t){e.$set(e.hook,"rule_type_id",t)},expression:"hook.rule_type_id"}},e._l(e.types,(function(e){return a("el-option",{key:e.id,staticStyle:{width:"100%"},attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"规则详情"}},[a("el-input",{attrs:{placeholder:"请输入HOOK规则，格式如：java.lang.String.<init>(java.lang.String)"},model:{value:e.hook.rule_value,callback:function(t){e.$set(e.hook,"rule_value",t)},expression:"hook.rule_value"}})],1),e._l(e.hook.source,(function(t,r){return[a("el-form-item",{key:"source"+r,attrs:{label:0===r?"污点来源":""}},[r>0?a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:"请选择逻辑关系"},model:{value:t.relation,callback:function(a){e.$set(t,"relation",a)},expression:"item.relation"}},e._l(e.relations,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:"请选择数据源"},on:{change:function(a){return e.changeOrigin(t)}},model:{value:t.origin,callback:function(a){e.$set(t,"origin",a)},expression:"item.origin"}},e._l(e.origins,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:"O"===t.value&&e.hook.source.some((function(e){return"O"===e.origin}))||"R"===t.value&&e.hook.source.some((function(e){return"R"===e.origin}))}})})),1),"P"===t.origin?a("el-input",{staticStyle:{width:"10%","margin-left":"10px"},attrs:{placeholder:"参数编号，从1开始"},model:{value:t.param,callback:function(a){e.$set(t,"param",a)},expression:"item.param"}}):e._e(),a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.addSource(e.hook.source)}}},[e._v("增加")]),e.hook.source.length>1?a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.deleteSource(e.hook.source,r)}}},[e._v("删除")]):e._e()],1)],1)]})),a("el-form-item",{attrs:{label:"污点跟踪"}},[a("el-radio",{attrs:{label:"true"},model:{value:e.hook.track,callback:function(t){e.$set(e.hook,"track",t)},expression:"hook.track"}},[e._v("启用")]),a("el-radio",{attrs:{label:"false"},model:{value:e.hook.track,callback:function(t){e.$set(e.hook,"track",t)},expression:"hook.track"}},[e._v("禁用")])],1),a("el-form-item",{attrs:{label:"继承深度"}},[a("el-radio",{attrs:{label:"false"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v("仅当前类")]),a("el-radio",{attrs:{label:"true"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v("仅子类")]),a("el-radio",{attrs:{label:"all"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v("当前类及其子类")])],1)],2),a("template",{slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.clearHook}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.enterHook}},[e._v("确定")])],1)],2)],1)},g=[],b=(a("99af"),a("4160"),a("c975"),a("fb6a"),a("45fc"),a("a434"),a("ac1f"),a("1276"),a("159b"),a("2909")),d=a("73ec"),m=function(e){Object(s["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.hookTypeDialog=!1,e.hookDialog=!1,e.hookType={type:"1",name:"",short_name:"",enable:0},e.types=[],e.hook={id:0,type:"1",rule_type_id:"",rule_value:"",source:[{relation:"",origin:"",param:""}],inherit:"",track:""},e.relations=[{label:"或",value:"|"},{label:"和",value:"&"}],e.origins=[{label:"对象",value:"O"},{label:"返回值",value:"R"},{label:"参数",value:"P"}],e.tableData=[],e.pageSize=20,e.currentPage=1,e.total=0,e}return Object(l["a"])(a,[{key:"splitAndIn",value:function(e,t){for(var a=e.split(t),r=0;r<a.length;r++)r%2!=0&&(a.splice(r,0,t),r++);return a}},{key:"makeParamsArr",value:function(e){function t(e,t){var a=[];if("P"===e[0]){var r=e.substring(1,e.length),n=r.split(",");n.forEach((function(e){a.some((function(e){return"P"===e.origin}))?a.push({relation:"&",origin:"P",param:e}):a.push({relation:t,origin:"P",param:e})}))}else a.push({relation:t,origin:e,param:""});return a}function a(e){var a=[];return 1==e.length?a.push.apply(a,Object(b["a"])(t(e[0],""))):a.push.apply(a,Object(b["a"])(t(e[1],e[0]))),a}for(var r=[],n=[],i=0,o=0;o<e.length;o++)"|"!=e[o]&&"&"!=e[o]||(r.push(e.slice(i,o)),i=o),o==e.length-1&&r.push(e.slice(i,e.length));for(var l=0;l<r.length;l++)n.push.apply(n,Object(b["a"])(a(r[l])));return n}},{key:"editRow",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a=this.splitAndIn(t.source,"|"),r=0;r<a.length;r++)a[r].indexOf("&")>-1&&(n=this.splitAndIn(a[r],"&"),a.splice.apply(a,[r,1].concat(Object(b["a"])(n))),r+=n.length);i=this.makeParamsArr(a),this.hook.rule_value=t.value,this.hook.id=t.id,this.hook.inherit=t.inherit,this.hook.source=i,this.hook.rule_type_id=t.rule_type_id,this.hookDialog=!0;case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTypes",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleTypes({type:this.ruleType});case 3:if(t=e.sent,a=t.status,r=t.msg,n=t.data,this.loadingDone(),201===a){e.next=11;break}return this.$message.error(r),e.abrupt("return");case 11:this.types=n;case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"addSource",value:function(e){e.push({relation:"",origin:"",param:""})}},{key:"deleteSource",value:function(e,t){e.splice(t,1),e[0].relation=""}},{key:"changeOrigin",value:function(e){"P"!==e.origin&&(e.param="")}},{key:"deleteRule",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleDelete({rule_id:t.id});case 3:if(a=e.sent,r=a.status,n=a.msg,this.loadingDone(),t.visible=!1,201===r){e.next=11;break}return this.$message.error(n),e.abrupt("return");case 11:return e.next=13,this.getTable();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeStatus",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.loadingStart(),0!==t.enable){e.next=9;break}return e.next=4,this.services.setting.ruleDisable({rule_id:t.id});case 4:n=e.sent,a=n.status,r=n.msg,e.next=14;break;case 9:return e.next=11,this.services.setting.ruleEnable({rule_id:t.id});case 11:i=e.sent,a=i.status,r=i.msg;case 14:if(this.loadingDone(),201===a){e.next=18;break}return this.$message.error(r),e.abrupt("return");case 18:return e.next=20,this.getTable();case 20:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"clearHookType",value:function(){this.hookType={type:this.ruleType,name:"",short_name:"",enable:0},this.hookTypeDialog=!1}},{key:"enterHookType",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleTypeAdd(this.hookType);case 3:if(t=e.sent,a=t.status,r=t.msg,this.loadingDone(),201===a){e.next=10;break}return this.$message.error(r),e.abrupt("return");case 10:return e.next=12,this.getTypes();case 12:this.clearHookType();case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"fmtType",value:function(e){switch(e){case"1":return"传播方法规则";case"2":return"污染源方法规则";case"3":return"过滤方法规则";case"4":return"危险方法规则";case"5":return"入口方法规则"}}},{key:"clearHook",value:function(){this.hook={id:0,type:this.ruleType,rule_type_id:"",rule_value:"",source:[{relation:"",origin:"",param:""}],inherit:"",track:""},this.hookDialog=!1}},{key:"fmtParams",value:function(e){var t="",a="";return e.forEach((function(e){"P"!==e.origin||t?"P"===e.origin&&t?t+=",".concat(e.param):a+="".concat(e.relation).concat(e.origin):t+="".concat(e.relation).concat(e.origin).concat(e.param)})),a+t}},{key:"enterHook",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n,i,o,l,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.hook.id){e.next=17;break}return this.loadingStart(),t=this.fmtParams(this.hook.source),e.next=5,this.services.setting.modifyAdd({rule_id:this.hook.id,rule_type_id:this.hook.rule_type_id,rule_value:this.hook.rule_value,rule_source:t,rule_target:"",inherit:this.hook.inherit,track:this.hook.track});case 5:if(a=e.sent,r=a.status,n=a.msg,this.loadingDone(),201===r){e.next=12;break}return this.$message.error(n),e.abrupt("return");case 12:return e.next=14,this.getTable();case 14:this.clearHook(),e.next=31;break;case 17:return this.loadingStart(),i=this.fmtParams(this.hook.source),e.next=21,this.services.setting.ruleAdd({rule_type_id:this.hook.rule_type_id,rule_value:this.hook.rule_value,rule_source:i,rule_target:"",inherit:this.hook.inherit,track:this.hook.track});case 21:if(o=e.sent,l=o.status,s=o.msg,this.loadingDone(),201===l){e.next=28;break}return this.$message.error(s),e.abrupt("return");case 28:return e.next=30,this.getTable();case 30:this.clearHook();case 31:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getTable",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.hookRuleList({page:this.currentPage,pageSize:this.pageSize,type:this.ruleType});case 3:if(t=e.sent,a=t.status,r=t.msg,n=t.data,i=t.page,this.loadingDone(),201===a){e.next=12;break}return this.$message.error(r),e.abrupt("return");case 12:this.total=i.alltotal,this.tableData=n;case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(e){this.pageSize=e,this.currentPage=1,this.getTable()}},{key:"handleCurrentChange",value:function(e){this.currentPage=e,this.getTable()}},{key:"created",value:function(){this.hookType.type=this.ruleType,this.hook.type=this.ruleType,this.getTable(),this.getTypes()}}]),a}(p["a"]);Object(c["b"])([Object(h["b"])({default:"0",type:String})],m.prototype,"ruleType",void 0),m=Object(c["b"])([Object(h["a"])({name:"HookTable",filters:{formatTimestamp:function(e){return Object(d["b"])(e)}}})],m);var v=m,k=v,y=(a("b944"),a("2877")),_=Object(y["a"])(k,f,g,!1,null,"52a51af1",null),x=_.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-body"},[a("div",{staticClass:"flex-right"},[a("el-button",{staticClass:"resetAllBtn",attrs:{size:"small"},on:{click:function(t){e.hookTypeDialog=!0}}},[e._v("添加规则类型")]),a("el-button",{staticClass:"resetAllBtn",attrs:{size:"small"},on:{click:function(t){e.hookDialog=!0}}},[e._v("添加规则")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{align:"center",prop:"rule_type",label:"规则类型",width:"160"}}),a("el-table-column",{attrs:{align:"center",prop:"value",label:"规则详情",width:"340"}}),a("el-table-column",{attrs:{align:"center",prop:"source",label:"污点输入","max-width":"100"}}),a("el-table-column",{attrs:{prop:"target",label:"污点输出","max-width":"100"}}),a("el-table-column",{attrs:{prop:"inherit",label:"HOOK深度",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("true"===t.row.inherit?"子类":"all"===t.row.inherit?"当前类及子类":"当前类")+" ")]}}])}),a("el-table-column",{attrs:{prop:"update_time",label:"修改时间",sortable:"true",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatTimestamp")(t.row.update_time))+" ")]}}])}),a("el-table-column",{attrs:{prop:"user",label:"创建者",width:"180"}}),a("el-table-column",{attrs:{prop:"address",label:"操作",align:"center",width:"290"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"启用","inactive-text":"禁用","active-value":1,"inactive-value":0},on:{change:function(a){return e.changeStatus(t.row)}},model:{value:t.row.enable,callback:function(a){e.$set(t.row,"enable",a)},expression:"scope.row.enable"}}),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success",size:"small"},on:{click:function(a){return e.editRow(t.row)}}},[e._v(" 编辑 ")]),a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.row.visible,callback:function(a){e.$set(t.row,"visible",a)},expression:"scope.row.visible"}},[a("p",[e._v("确定删除吗？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.visible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.deleteRule(t.row)}}},[e._v("确定")])],1),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{slot:"reference",type:"danger",size:"small"},slot:"reference"},[e._v(" 删除 ")])],1)]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,background:"",layout:" prev, pager, next, jumper,total, sizes",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{visible:e.hookTypeDialog},on:{"update:visible":function(t){e.hookTypeDialog=t}}},[a("el-form",{attrs:{model:e.hookType,"label-width":"80px",size:"small"}},[a("el-form-item",{attrs:{label:"规则集"}},[a("span",[e._v(e._s(e.fmtType(e.hookType.type)))])]),a("el-form-item",{attrs:{label:"类型名称"}},[a("el-input",{attrs:{placeholder:"请输入类型名称，如：String、StringBuilder等，建议使用类名"},model:{value:e.hookType.name,callback:function(t){e.$set(e.hookType,"name",t)},expression:"hookType.name"}})],1),a("el-form-item",{attrs:{label:"类型简称"}},[a("el-input",{attrs:{placeholder:"请输入类型简称，如：字符串-01、字符串-02，方便自己查看"},model:{value:e.hookType.short_name,callback:function(t){e.$set(e.hookType,"short_name",t)},expression:"hookType.short_name"}})],1),a("el-form-item",{attrs:{label:"是否启用"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"启用","inactive-text":"禁用","active-value":1,"inactive-value":0},model:{value:e.hookType.enable,callback:function(t){e.$set(e.hookType,"enable",t)},expression:"hookType.enable"}})],1)],1),a("template",{slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.clearHookType}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.enterHookType}},[e._v("确定")])],1)],2),a("el-dialog",{attrs:{visible:e.hookDialog},on:{"update:visible":function(t){e.hookDialog=t}}},[a("el-form",{attrs:{model:e.hook,size:"small","label-width":"80px"}},[a("el-form-item",{attrs:{label:"规则集"}},[a("span",[e._v(e._s(e.fmtType(e.hook.type)))])]),a("el-form-item",{attrs:{label:"规则类型"}},[a("el-select",{attrs:{placeholder:"请选择规则类型"},model:{value:e.hook.rule_type_id,callback:function(t){e.$set(e.hook,"rule_type_id",t)},expression:"hook.rule_type_id"}},e._l(e.types,(function(e){return a("el-option",{key:e.id,staticStyle:{width:"100%"},attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"规则详情"}},[a("el-input",{attrs:{placeholder:"请输入HOOK规则，格式如：java.lang.String.<init>(java.lang.String)"},model:{value:e.hook.rule_value,callback:function(t){e.$set(e.hook,"rule_value",t)},expression:"hook.rule_value"}})],1),e._l(e.hook.source,(function(t,r){return[a("el-form-item",{key:"source-"+r,attrs:{label:0===r?"污点来源":" "}},[r>0?a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:"请选择逻辑关系"},model:{value:t.relation,callback:function(a){e.$set(t,"relation",a)},expression:"item.relation"}},e._l(e.relations,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:"请选择数据源"},on:{change:function(a){return e.changeOrigin(t)}},model:{value:t.origin,callback:function(a){e.$set(t,"origin",a)},expression:"item.origin"}},e._l(e.origins,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:"O"===t.value&&e.hook.source.some((function(e){return"O"===e.origin}))||"R"===t.value&&e.hook.source.some((function(e){return"R"===e.origin}))}})})),1),"P"===t.origin?a("el-input",{staticStyle:{width:"18%","margin-left":"10px"},attrs:{placeholder:"参数编号，从1开始"},model:{value:t.param,callback:function(a){e.$set(t,"param",a)},expression:"item.param"}}):e._e(),a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.addSource(e.hook.source)}}},[e._v("增加")]),e.hook.source.length>1?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteSource(e.hook.source,r)}}},[e._v("删除")]):e._e()],1)],1)]})),e._l(e.hook.target,(function(t,r){return[a("el-form-item",{key:"target"+r,attrs:{label:0===r?"污点去向":""}},[r>0?a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:"请选择逻辑关系"},model:{value:t.relation,callback:function(a){e.$set(t,"relation",a)},expression:"item.relation"}},e._l(e.relations,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:"请选择数据源"},on:{change:function(a){return e.changeOrigin(t)}},model:{value:t.origin,callback:function(a){e.$set(t,"origin",a)},expression:"item.origin"}},e._l(e.origins,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:"O"===t.value&&e.hook.target.some((function(e){return"O"===e.origin}))||"R"===t.value&&e.hook.target.some((function(e){return"R"===e.origin}))}})})),1),"P"===t.origin?a("el-input",{staticStyle:{width:"18%","margin-left":"10px"},attrs:{placeholder:"参数编号，从1开始"},model:{value:t.param,callback:function(a){e.$set(t,"param",a)},expression:"item.param"}}):e._e(),a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.addSource(e.hook.target)}}},[e._v("增加")]),e.hook.target.length>1?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteSource(e.hook.target,r)}}},[e._v("删除")]):e._e()],1)],1)]})),a("el-form-item",{attrs:{label:"继承深度"}},[a("el-radio",{attrs:{selected:"",label:"false"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v("仅当前类")]),a("el-radio",{attrs:{label:"true"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v("仅子类")]),a("el-radio",{attrs:{label:"all"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v("当前类及其子类")])],1)],2),a("template",{slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.clearHook}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.enterHook}},[e._v("确定")])],1)],2)],1)},T=[],S=function(e){Object(s["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.hookTypeDialog=!1,e.hookDialog=!1,e.hookType={type:"1",name:"",short_name:"",enable:0},e.types=[],e.hook={id:0,type:"1",rule_type_id:"",rule_value:"",source:[{relation:"",origin:"",param:""}],target:[{relation:"",origin:"",param:""}],inherit:""},e.relations=[{label:"或",value:"|"},{label:"和",value:"&"}],e.origins=[{label:"对象",value:"O"},{label:"返回值",value:"R"},{label:"参数",value:"P"}],e.tableData=[],e.pageSize=20,e.currentPage=1,e.total=0,e}return Object(l["a"])(a,[{key:"splitAndIn",value:function(e,t){for(var a=e.split(t),r=0;r<a.length;r++)r%2!=0&&(a.splice(r,0,t),r++);return a}},{key:"makeParamsArr",value:function(e){function t(e,t){var a=[];if("P"===e[0]){var r=e.substring(1,e.length),n=r.split(",");n.forEach((function(e){a.some((function(e){return"P"===e.origin}))?a.push({relation:"&",origin:"P",param:e}):a.push({relation:t,origin:"P",param:e})}))}else a.push({relation:t,origin:e,param:""});return a}function a(e){var a=[];return 1==e.length?a.push.apply(a,Object(b["a"])(t(e[0],""))):a.push.apply(a,Object(b["a"])(t(e[1],e[0]))),a}for(var r=[],n=[],i=0,o=0;o<e.length;o++)"|"!=e[o]&&"&"!=e[o]||(r.push(e.slice(i,o)),i=o),o==e.length-1&&r.push(e.slice(i,e.length));for(var l=0;l<r.length;l++)n.push.apply(n,Object(b["a"])(a(r[l])));return n}},{key:"editRow",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,i,o,l,s,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a=this.splitAndIn(t.source,"|"),r=0;r<a.length;r++)a[r].indexOf("&")>-1&&(n=this.splitAndIn(a[r],"&"),a.splice.apply(a,[r,1].concat(Object(b["a"])(n))),r+=n.length);for(i=this.makeParamsArr(a),o=this.splitAndIn(t.target,"|"),l=0;l<o.length;l++)o[l].indexOf("&")>-1&&(s=this.splitAndIn(o[l],"&"),a.splice.apply(a,[l,1].concat(Object(b["a"])(s))),l+=s.length);u=this.makeParamsArr(o),this.hook.rule_value=t.value,this.hook.id=t.id,this.hook.inherit=t.inherit,this.hook.source=i,this.hook.target=u,this.hook.rule_type_id=t.rule_type_id,this.hookDialog=!0;case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTypes",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleTypes({type:this.ruleType});case 3:if(t=e.sent,a=t.status,r=t.msg,n=t.data,this.loadingDone(),201===a){e.next=11;break}return this.$message.error(r),e.abrupt("return");case 11:this.types=n;case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"deleteRule",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleDelete({rule_id:t.id});case 3:if(a=e.sent,r=a.status,n=a.msg,this.loadingDone(),t.visible=!1,201===r){e.next=11;break}return this.$message.error(n),e.abrupt("return");case 11:return e.next=13,this.getTable();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"addSource",value:function(e){e.push({relation:"",origin:"",param:""})}},{key:"deleteSource",value:function(e,t){e.splice(t,1),e[0].relation=""}},{key:"changeOrigin",value:function(e){"P"!==e.origin&&(e.param="")}},{key:"changeStatus",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.loadingStart(),0!==t.enable){e.next=9;break}return e.next=4,this.services.setting.ruleDisable({rule_id:t.id});case 4:n=e.sent,a=n.status,r=n.msg,e.next=14;break;case 9:return e.next=11,this.services.setting.ruleEnable({rule_id:t.id});case 11:i=e.sent,a=i.status,r=i.msg;case 14:if(this.loadingDone(),201===a){e.next=18;break}return this.$message.error(r),e.abrupt("return");case 18:return e.next=20,this.getTable();case 20:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"clearHookType",value:function(){this.hookType={type:this.ruleType,name:"",short_name:"",enable:0},this.hookTypeDialog=!1}},{key:"enterHookType",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleTypeAdd(this.hookType);case 3:if(t=e.sent,a=t.status,r=t.msg,this.loadingDone(),201===a){e.next=10;break}return this.$message.error(r),e.abrupt("return");case 10:return e.next=12,this.getTypes();case 12:this.clearHookType();case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"fmtType",value:function(e){switch(e){case"1":return"传播方法规则";case"2":return"污染源方法规则";case"3":return"过滤方法规则";case"4":return"危险方法规则";case"5":return"入口方法规则"}}},{key:"clearHook",value:function(){this.hook={id:0,type:this.ruleType,rule_type_id:"",rule_value:"",source:[{relation:"",origin:"",param:""}],target:[{relation:"",origin:"",param:""}],inherit:""},this.hookDialog=!1}},{key:"fmtParams",value:function(e){var t="",a="";return e.forEach((function(e){"P"!==e.origin||t?"P"===e.origin&&t?t+=",".concat(e.param):a+="".concat(e.relation).concat(e.origin):t+="".concat(e.relation).concat(e.origin).concat(e.param)})),a+t}},{key:"enterHook",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n,i,o,l,s,u,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.hook.id){e.next=18;break}return this.loadingStart(),t=this.fmtParams(this.hook.source),a=this.fmtParams(this.hook.target),e.next=6,this.services.setting.modifyAdd({rule_id:this.hook.id,rule_type_id:this.hook.rule_type_id,rule_value:this.hook.rule_value,rule_target:a,rule_source:t,inherit:this.hook.inherit,track:"false"});case 6:if(r=e.sent,n=r.status,i=r.msg,this.loadingDone(),201===n){e.next=13;break}return this.$message.error(i),e.abrupt("return");case 13:return e.next=15,this.getTable();case 15:this.clearHook(),e.next=33;break;case 18:return this.loadingStart(),o=this.fmtParams(this.hook.source),l=this.fmtParams(this.hook.target),e.next=23,this.services.setting.ruleAdd({rule_type_id:this.hook.rule_type_id,rule_value:this.hook.rule_value,rule_target:l,rule_source:o,inherit:this.hook.inherit,track:"false"});case 23:if(s=e.sent,u=s.status,c=s.msg,this.loadingDone(),201===u){e.next=30;break}return this.$message.error(c),e.abrupt("return");case 30:return e.next=32,this.getTable();case 32:this.clearHook();case 33:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getTable",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.hookRuleList({page:this.currentPage,pageSize:this.pageSize,type:this.ruleType});case 3:if(t=e.sent,a=t.status,r=t.msg,n=t.data,i=t.page,this.loadingDone(),201===a){e.next=12;break}return this.$message.error(r),e.abrupt("return");case 12:this.total=i.alltotal,this.tableData=n;case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(e){this.pageSize=e,this.currentPage=1,this.getTable()}},{key:"handleCurrentChange",value:function(e){this.currentPage=e,this.getTable()}},{key:"created",value:function(){this.hookType.type=this.ruleType,this.hook.type=this.ruleType,this.getTable(),this.getTypes()}}]),a}(p["a"]);Object(c["b"])([Object(h["b"])({default:"0",type:String})],S.prototype,"ruleType",void 0),S=Object(c["b"])([Object(h["a"])({name:"HookTable",filters:{formatTimestamp:function(e){return Object(d["b"])(e)}}})],S);var O=S,j=O,R=(a("07ff"),Object(y["a"])(j,w,T,!1,null,"a4e3ab4a",null)),D=R.exports,$=function(e){Object(s["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.type="2",e.base={ruleCount:0,typeCount:0,sinkCount:0},e}return Object(l["a"])(a,[{key:"getBase",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.hookRuleSummary();case 3:if(t=e.sent,a=t.status,r=t.msg,n=t.data,this.loadingDone(),201===a){e.next=11;break}return this.$message.error(r),e.abrupt("return");case 11:this.base=n;case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){this.getBase()}}]),a}(p["a"]);$=Object(c["b"])([Object(h["a"])({name:"HookRule",components:{DangerTable:x,HookTable:D}})],$);var z=$,C=z,P=(a("cab4"),a("7d19"),Object(y["a"])(C,r,n,!1,null,"36930752",null));t["default"]=P.exports},a434:function(e,t,a){"use strict";var r=a("23e7"),n=a("23cb"),i=a("a691"),o=a("50c4"),l=a("7b0b"),s=a("65f0"),u=a("8418"),c=a("1dde"),h=a("ae40"),p=c("splice"),f=h("splice",{ACCESSORS:!0,0:0,1:2}),g=Math.max,b=Math.min,d=9007199254740991,m="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!p||!f},{splice:function(e,t){var a,r,c,h,p,f,v=l(this),k=o(v.length),y=n(e,k),_=arguments.length;if(0===_?a=r=0:1===_?(a=0,r=k-y):(a=_-2,r=b(g(i(t),0),k-y)),k+a-r>d)throw TypeError(m);for(c=s(v,r),h=0;h<r;h++)p=y+h,p in v&&u(c,h,v[p]);if(c.length=r,a<r){for(h=y;h<k-r;h++)p=h+r,f=h+a,p in v?v[f]=v[p]:delete v[f];for(h=k;h>k-r+a;h--)delete v[h-1]}else if(a>r)for(h=k-r;h>y;h--)p=h+r-1,f=h+a-1,p in v?v[f]=v[p]:delete v[f];for(h=0;h<a;h++)v[h+y]=arguments[h+2];return v.length=k-r+a,c}})},b944:function(e,t,a){"use strict";a("eb91")},cab4:function(e,t,a){"use strict";a("55fe")},eb91:function(e,t,a){},fda6:function(e,t,a){}}]);
//# sourceMappingURL=chunk-68a36910.8096dd71.js.map