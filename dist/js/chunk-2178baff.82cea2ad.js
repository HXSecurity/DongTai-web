(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2178baff"],{1276:function(e,t,a){"use strict";var i=a("d784"),s=a("44e7"),n=a("825a"),l=a("1d80"),r=a("4840"),o=a("8aa5"),c=a("50c4"),u=a("14c3"),v=a("9263"),p=a("d039"),d=[].push,f=Math.min,h=4294967295,g=!p((function(){return!RegExp(h,"y")}));i("split",2,(function(e,t,a){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,a){var i=String(l(this)),n=void 0===a?h:a>>>0;if(0===n)return[];if(void 0===e)return[i];if(!s(e))return t.call(i,e,n);var r,o,c,u=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,g=new RegExp(e.source,p+"g");while(r=v.call(g,i)){if(o=g.lastIndex,o>f&&(u.push(i.slice(f,r.index)),r.length>1&&r.index<i.length&&d.apply(u,r.slice(1)),c=r[0].length,f=o,u.length>=n))break;g.lastIndex===r.index&&g.lastIndex++}return f===i.length?!c&&g.test("")||u.push(""):u.push(i.slice(f)),u.length>n?u.slice(0,n):u}:"0".split(void 0,0).length?function(e,a){return void 0===e&&0===a?[]:t.call(this,e,a)}:t,[function(t,a){var s=l(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,s,a):i.call(String(s),t,a)},function(e,s){var l=a(i,e,this,s,i!==t);if(l.done)return l.value;var v=n(e),p=String(this),d=r(v,RegExp),b=v.unicode,m=(v.ignoreCase?"i":"")+(v.multiline?"m":"")+(v.unicode?"u":"")+(g?"y":"g"),y=new d(g?v:"^(?:"+v.source+")",m),_=void 0===s?h:s>>>0;if(0===_)return[];if(0===p.length)return null===u(y,p)?[p]:[];var w=0,C=0,j=[];while(C<p.length){y.lastIndex=g?C:0;var O,x=u(y,g?p:p.slice(C));if(null===x||(O=f(c(y.lastIndex+(g?0:C)),p.length))===w)C=o(p,C,b);else{if(j.push(p.slice(w,C)),j.length===_)return j;for(var D=1;D<=x.length-1;D++)if(j.push(x[D]),j.length===_)return j;C=w=O}}return j.push(p.slice(w)),j}]}),!g)},"13d5":function(e,t,a){"use strict";var i=a("23e7"),s=a("d58f").left,n=a("a640"),l=a("ae40"),r=a("2d00"),o=a("605d"),c=n("reduce"),u=l("reduce",{1:0}),v=!o&&r>79&&r<83;i({target:"Array",proto:!0,forced:!c||!u||v},{reduce:function(e){return s(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"2b88":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("main",{staticClass:"container"},[e.sliderWarpContract?e._e():a("div",{staticClass:"fixed-warp"},[a("div",{staticClass:"slider-warp"},[a("div",{staticClass:"titleForm flex-row-space-between"},[a("el-select",{staticStyle:{width:"90px"},attrs:{size:"mini"},model:{value:e.searchObj.order,callback:function(t){e.$set(e.searchObj,"order",t)},expression:"searchObj.order"}},e._l(e.orderOptions,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1),a("el-input",{staticStyle:{width:"106px"},attrs:{size:"mini"},model:{value:e.searchObj.url,callback:function(t){e.$set(e.searchObj,"url",t)},expression:"searchObj.url"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},on:{click:e.newSelectData},slot:"suffix"})])],1),a("div",{staticClass:"page-line flex-column-center"},[a("div",{staticClass:"flex-row-space-between"},[a("div",{staticClass:"flex-column-center"},[a("el-pagination",{attrs:{small:"",layout:"prev, next",total:e.total,"current-page":e.page,"page-size":10},on:{"current-change":e.currentChange}})],1),a("div",{staticClass:"flex-column-center"},[a("span",{staticStyle:{color:"#969ba4","line-height":"25px"}},[a("strong",{staticStyle:{color:"#38435a","font-weight":"400"}},[e._v(e._s(e.page))]),e._v("/"+e._s(Math.ceil(e.total/10))+" ")])]),a("div",{staticClass:"flex-column-center"},[a("el-button",{staticStyle:{color:"#5782db"},attrs:{type:"text"},on:{click:e.getTableData}},[e._v(" "+e._s(e.$t("views.vulnDetail.reload"))+" ")])],1)])]),e._l(e.tableData,(function(t){return a("div",{key:t.id,staticClass:"card",class:t.id===e.selectedId?e.cardRowClassName(!0,t.index):e.cardRowClassName(!1,t.index),attrs:{"track-by":"$index"},on:{click:function(a){return e.idChange(t.id)}}},[a("div",{staticClass:"titleLine"},[e._v(" "+e._s(t.uri+" "+e.$t("views.vulnDetail.has")+" "+t.type+" "+e.$t("views.vulnDetail.vuln"))+" ")]),a("div",{staticClass:"infoLine flex-row-space-between"},[a("span",{style:1===t.level_type?{color:"#EA7171"}:2===t.level_type?{color:"#F39D0A"}:3===t.level_type?{color:"#2E8FE9"}:4===t.level_type?{color:"#7BC1AB"}:""},[a("i",{staticClass:"iconfont iconweixian",staticStyle:{"font-size":"14px"}}),e._v(" "+e._s(t.level)+" ")]),a("span",[a("i",{staticClass:"iconfont iconshijian-2",staticStyle:{"font-size":"14px"}}),e._v(" "+e._s(t.latest_time)+" ")])])])}))],2)]),a("div",{staticClass:"operateCol",style:e.sliderWarpContract?{}:{"margin-left":"228px"}},[a("div",{staticStyle:{height:"100%"}},[a("i",{staticClass:"iconfont operateIcon",class:e.sliderWarpContract?"iconopen1-2":"iconopen11",on:{click:function(t){e.sliderWarpContract=!e.sliderWarpContract}}})])]),e.vulnObj.vul.url?a("div",{staticClass:"vuln-warp",class:e.sliderWarpContract?"slider-warp-contract":"slider-warp-spreadOut"},[a("div",{staticClass:"vuln-title flex-row-space-between"},[a("div",{staticStyle:{flex:"1","max-width":"700px","word-break":"break-all"}},[e._v(" "+e._s(""+e.vulnObj.vul.url+e.$t("views.vulnDetail.is")+e.vulnObj.vul.http_method+e.$t("views.vulnDetail.reqHas")+e.vulnObj.vul.type+e.$t("views.vulnDetail.vuln")+(e.vulnObj.vul.taint_position?","+e.$t("views.vulnDetail.position")+":"+e.vulnObj.vul.taint_position:""))+" ")]),a("div",{staticClass:"btnWarp"},[a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:e.recheckVul}},[a("i",{staticClass:"iconfont iconjiance-copy"}),e._v(" "+e._s(e.$t("views.vulnDetail.recheck"))+" ")]),a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:e.exportVul}},[a("i",{staticClass:"iconfont icondaochu-5"}),e._v(" "+e._s(e.$t("views.vulnDetail.export"))+" ")]),a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:function(t){e.deleteDialogOpen=!0}}},[a("i",{staticClass:"iconfont iconshanchu-6"}),e._v(" "+e._s(e.$t("views.vulnDetail.delete"))+" ")])],1)]),a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.baseInfo"))+" ")]),a("div",{staticClass:"infoWarp"},[a("div",{staticClass:"infoLine flex-row-space-between"},[a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconfuwuqi-3"}),e._v(" "+e._s(e.$t("views.vulnDetail.serverIp"))+": ")]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.vulnObj.server.ip,placement:"top-start"}},[a("span",{staticClass:"dot"},[e._v(e._s(e.vulnObj.server.ip))])])],1),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconIp"}),e._v(" "+e._s(e.$t("views.vulnDetail.clientIp"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.client_ip))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconzhongjianjian"}),e._v(" "+e._s(e.$t("views.vulnDetail.middleware"))+": ")]),a("span",{staticStyle:{width:"140px",overflow:"hidden"}},[a("span",[e._v(e._s(e.vulnObj.server.container))])])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconyuyan-2"}),e._v(" "+e._s(e.$t("views.vulnDetail.language"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.language))])])]),a("div",{staticClass:"infoLine flex-row-space-between"},[a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconproject"}),e._v(" "+e._s(e.$t("views.vulnDetail.projectName"))+": ")]),a("span",{class:e.vulnObj.vul.project_id&&"project-name",on:{click:function(t){return e.$router.push("/project/projectDetail/"+e.vulnObj.vul.project_id)}}},[e._v(e._s(e.vulnObj.vul.project_name))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconicon_details_banben"}),e._v(" "+e._s(e.$t("views.vulnDetail.version"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.project_version))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconshuju1"}),e._v(" "+e._s(e.$t("views.vulnDetail.taintParamName"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.param_name&&Object.values(e.vulnObj.vul.param_name).join(",")||e.$t("views.vulnDetail.empty")))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconloudong"}),e._v(" "+e._s(e.$t("views.vulnDetail.taintValue"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.taint_value||0))])])]),a("div",{staticClass:"infoLine flex-row-space-between"},[a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconshijian-3"}),e._v(" "+e._s(e.$t("views.vulnDetail.first_time"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.first_time))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconcishu-2"}),e._v(" "+e._s(e.$t("views.vulnDetail.counts"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.counts))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconweixian-2"}),e._v(" "+e._s(e.$t("views.vulnDetail.level"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.level))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconicon_yingyong_zhuagntai"}),e._v(" "+e._s(e.$t("views.vulnDetail.state"))+": ")]),a("el-select",{staticStyle:{width:"40%"},attrs:{placeholder:e.$t("views.vulnDetail.untreated"),size:"mini",filterable:"","allow-create":""},on:{change:e.changeStatus},model:{value:e.vulnObj.vul.status,callback:function(t){e.$set(e.vulnObj.vul,"status",t)},expression:"vulnObj.vul.status"}},e._l(e.statusOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),a("div",{staticClass:"infoLine flex-row-space-between"},[a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info",staticStyle:{flex:"2.5"}},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconapp"}),e._v(" "+e._s(e.$t("views.vulnDetail.agent"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.agent_name))])])])]),a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.vulnDesc"))+" ")]),a("div",{staticClass:"vulnDesc"},[e._v(" "+e._s(e.vulnObj.strategy.desc)+" ")]),a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.httpRequest"))+" "),a("el-button",{staticStyle:{"margin-left":"8px",padding:"6px",background:"#4a72ae",color:"#fff"},attrs:{size:"mini"},on:{click:e.goToPoolDetail}},[a("i",{staticClass:"iconfont icongears",staticStyle:{"margin-right":"6px","font-size":"12px"}}),e._v(e._s(e.$t("views.vulnDetail.replay")))])],1),a("div",{staticClass:"selectForm"},[a("div",{staticClass:"select-item"}),e._l(e.httpOptions,(function(t){return a("div",{key:t.value,staticClass:"select-item",class:t.value===e.state&&"active",on:{click:function(a){e.state=t.value}}},[e._v(" "+e._s(t.label)+" ")])}))],2),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.state,expression:"state === 1"}],staticClass:"markdownContent httpRequest"},[a("MyMarkdownIt",{staticStyle:{color:"#747c8c"},attrs:{content:e.req_md}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.state,expression:"state === 0"}],staticClass:"markdownContent httpRequest"},[a("MyMarkdownIt",{staticStyle:{color:"#747c8c"},attrs:{content:e.res_md}})],1),e.vulnObj.vul.graph&&e.vulnObj.vul.graph.length>0?a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.graph"))+" ")]):e._e(),e.vulnObj.vul.graph&&e.vulnObj.vul.graph.length>0?a("div",{staticClass:"graphModule flex-row-space-between"},[a("div",{staticClass:"left-warp"},[a("div",{staticClass:"flex-row-space-between dot-list"},[a("div",{staticClass:"tip"},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{color:"#5491ef"}}),a("span",[e._v(e._s(e.$t("views.vulnDetail.stainSource")))])]),a("div",{staticClass:"tip"},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{color:"#f3bc3f"}}),a("span",[e._v(e._s(e.$t("views.vulnDetail.communicationMethod")))])]),a("div",{staticClass:"tip"},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{color:"#ec984f"}}),a("span",[e._v(e._s(e.$t("views.vulnDetail.dangerMethod")))])])]),e._l(e.vulnObj.vul.graph,(function(t,i){return a("div",{key:i,staticClass:"vuln-pic"},[a("div",{staticClass:"flex-column-center",staticStyle:{padding:"0 5px"}},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{color:"#ec984f"},style:0===i?{color:"#5491ef"}:i===e.vulnObj.vul.graph.length-1?{color:"#ec984f"}:{color:"#f3bc3f"}})]),a("div",{staticClass:"info"},[a("div",{staticClass:"nodeLine"},[a("div",{staticClass:"node"},[e._v(" "+e._s(t.node)+" ")])]),a("div",{staticClass:"nodeLine"},[a("div",{staticClass:"code"},[a("div",{directives:[{name:"dompurify-html",rawName:"v-dompurify-html",value:t.code,expression:"item.code"}]})]),a("div",{staticClass:"tag-list"},[t.tag?a("div",{staticClass:"tag"},[e._v(" "+e._s(t.tag)+" ")]):e._e(),a("el-tooltip",{staticClass:"item",attrs:{effect:"light",disabled:t.file.length<30,content:t.file,placement:"top"}},[a("div",{staticClass:"file"},[e._v("file: "+e._s(t.file))])]),a("div",{staticClass:"line"},[e._v("line:"+e._s(t.line_number))])],1)])])])}))],2)]):e._e(),e.vulnObj.strategy.repair_suggestion?a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.suggest"))+" ")]):e._e(),e.vulnObj.strategy.repair_suggestion?a("div",{staticClass:"markdownContent"},[a("MyMarkdownIt",{attrs:{content:e.vulnObj.strategy.repair_suggestion}})],1):e._e(),e.vulnObj.server.runtime?a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.devEnv"))+" ")]):e._e(),e.vulnObj.server.runtime?a("div",{staticClass:"baseInfo"},[a("div",{staticClass:"base-line",staticStyle:{padding:"10px 0px",height:"10px"}},[a("span",[e._v(e._s(e.vulnObj.server.runtime))])])]):e._e(),a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.path"))+" ")]),a("div",{staticClass:"baseInfo"},[a("div",{staticClass:"base-line"},[a("span",{staticStyle:{color:"black","font-family":"PingFangSC-Medium, PingFang SC",display:"block"}},[e._v(" "+e._s(e.$t("views.vulnDetail.command"))+" ")]),a("span",{staticStyle:{display:"block","margin-top":"6px"}},[e._v(e._s(e.vulnObj.server.command))])]),e.vulnObj.server.environment?a("div",{staticClass:"base-line"},[a("span",{staticStyle:{color:"black","font-family":"PingFangSC-Medium, PingFang SC"}},[e._v(e._s(e.$t("views.vulnDetail.other")))])]):e._e(),e.vulnObj.server.environment?a("div",{staticClass:"base-line",staticStyle:{"padding-top":"6px"}},[a("span",{staticStyle:{color:"#849ed8"}},[e._v(e._s(e.vulnObj.server.environment)+" ")])]):e._e()])]):e._e(),a("el-dialog",{attrs:{visible:e.deleteDialogOpen,title:e.$t("views.vulnDetail.deleteVuln"),width:"25%"},on:{"update:visible":function(t){e.deleteDialogOpen=t}}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",{staticStyle:{color:"#959fb4"}},[e._v("$t('views.vulnDetail.deleteVulnInfo')")]),a("p",{staticStyle:{color:"#959fb4","margin-top":"14px"}},[e._v(" "+e._s(e.$t("views.vulnDetail.deleteVulnDesc"))+" ")])]),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"confirmDel",attrs:{type:"text"},on:{click:e.vulnDelete}},[e._v(" "+e._s(e.$t("views.vulnDetail.deleteVulnEnter"))+" ")]),a("el-button",{staticClass:"cancelDel",attrs:{type:"text"},on:{click:function(t){e.deleteDialogOpen=!1}}},[e._v(" "+e._s(e.$t("views.vulnDetail.cancel"))+" ")])],1)])],1)},s=[],n=(a("99af"),a("4160"),a("c975"),a("a15b"),a("13d5"),a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("3ca3"),a("5319"),a("1276"),a("159b"),a("ddb0"),a("2b3d"),a("5530")),l=(a("96cf"),a("1da1")),r=a("d4ec"),o=a("bee2"),c=a("262e"),u=a("2caf"),v=a("9ab4"),p=a("60a3"),d=a("73ec"),f=a("8c73"),h=a("b32d"),g=a("4328"),b=a.n(g),m=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.sliderWarpContract=!1,e.deleteDialogOpen=!1,e.statusOptions=[{value:"已上报",label:e.$t("views.vulnDetail.reported")},{value:"已确认",label:e.$t("views.vulnDetail.confirmed")},{value:"已修复",label:e.$t("views.vulnDetail.fixed")},{value:"已忽略",label:e.$t("views.vulnDetail.ignored")}],e.state=1,e.httpOptions=[{value:1,label:e.$t("views.vulnDetail.req")},{value:0,label:e.$t("views.vulnDetail.res")}],e.vulnObj={vul:{url:"",uri:"",http_method:"",type:"",taint_position:"",first_time:0,latest_time:0,project_name:"",project_id:0,language:"",level:"",counts:0,req_header:"",graph:[],context_path:"",taint_value:"",param_name:""},server:{name:"",hostname:"",ip:"",port:0,container:"",container_path:"",runtime:"",environment:"",command:""},strategy:{desc:"",sample_code:"",repair_suggestion:""}},e.tableData=[],e.page=1,e.selectedId=0,e.total=0,e.cardIndex=0,e.searchObj={language:"",level:"",type:"",project_name:"",url:"",order:""},e.orderOptions=[{label:e.$t("views.vulnList.orderOptions.type"),value:"type"},{label:e.$t("views.vulnList.orderOptions.level"),value:"level"},{label:e.$t("views.vulnList.orderOptions.url"),value:"url"},{label:e.$t("views.vulnList.orderOptions.latest_time"),value:"latest_time"},{label:e.$t("views.vulnList.orderOptions.first_time"),value:"first_time"}],e.req_md="",e.res_md="",e}return Object(o["a"])(a,[{key:"created",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.page=parseInt(this.$route.params.page),this.selectedId=parseInt(this.$route.params.id),this.cardIndex=0,e.next=5,this.getVulnDetail();case 5:return e.next=7,this.getTableData();case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"goToPoolDetail",value:function(){if(this.vulnObj.vul.method_pool_id){var e=this.$router.resolve({path:"/taint/poolDetail/".concat(this.vulnObj.vul.method_pool_id,"?activeName=flowDebug")}),t=e.href;window.open(t,"_blank")}else this.$message({showClose:!0,message:this.$t("views.vulnDetail.canNotReplay"),type:"error"})}},{key:"newSelectData",value:function(){this.page=1,this.getTableData()}},{key:"currentChange",value:function(e){this.page=e,this.getTableData()}},{key:"changeStatus",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.services.vuln.changeStatus({id:this.selectedId,status:t});case 2:a=e.sent,201===a.status?this.$message({type:"success",message:a.msg,showClose:!0}):this.$message({type:"error",message:a.msg,showClose:!0});case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTableData",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s,l,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={page:this.page,pageSize:10,language:this.searchObj.language,level:this.searchObj.level,type:this.searchObj.type,project_name:this.searchObj.project_name,url:this.searchObj.url,order:this.searchObj.order,status:this.$route.query.status},this.loadingStart(),e.next=4,this.services.vuln.vulnList(t);case 4:if(a=e.sent,i=a.status,s=a.data,l=a.page,r=a.msg,this.loadingDone(),201===i){e.next=13;break}return this.$message({type:"error",message:r,showClose:!0}),e.abrupt("return");case 13:this.tableData=s.reduce((function(e,t){return e.push(Object(n["a"])(Object(n["a"])({},t),{},{latest_time:Object(d["c"])(t.latest_time)})),e}),[]),this.total=l.alltotal;case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"idChange",value:function(e){this.selectedId=e,this.getVulnDetail()}},{key:"isJSON",value:function(e){if("string"==typeof e)try{return JSON.parse(e),!0}catch(t){return console.log(t),!1}}},{key:"getVulnDetail",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s,l=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.vuln.getVulnDetail(this.selectedId);case 3:if(t=e.sent,a=t.data,i=t.status,s=t.msg,this.loadingDone(),201===i){e.next=11;break}return this.$message({type:"error",message:s,showClose:!0}),e.abrupt("return");case 11:this.$nextTick((function(){function e(e,t){var a=new RegExp(t,"gi");return e.replace(a,(function(e){return"<tt style='color:red'>"+e+"</tt>"}))}var t=a.vul.req_header.split("<").join("&lt;").split("*").join("\\*"),i=t.split("\n");try{var s=function(t){switch(t){case"GET":var s=i[0].split(" "),n=s[1].split("?"),r=b.a.parse(n[1]),o=e(n[1],r[a.vul.param_name[t]]);n[1]=o,s[1]=n.join("?"),i[0]=s.join(" ");break;case"POST":if(l.isJSON(i[i.length-1])){var c=JSON.parse(i[i.length-1]),u=e(i[i.length-1],c[a.vul.param_name[t]]);i[i.length-1]=u}else{var v=b.a.parse(i[i.length-1]),p=e(i[i.length-1],v[a.vul.param_name[t]]);i[i.length-1]=p}break;case"COOKIE":i.forEach((function(s,n){if(s.indexOf("cookie:")>-1){var l=s.split(":"),r=b.a.parse(l[1]),o=e(l[1],r[a.vul.param_name[t]]);l[1]=o,i[n]=l.join(":")}}));break;case"PATH":var d=i[0].split("?"),f=e(d[0],a.vul.param_name[t]);d[0]=f,i[0]=d.join("?");break;case"HEADER":i.forEach((function(s,n){s.indexOf(a.vul.param_name[t])>-1&&(i[n]=e(s,s.split(":")[1]))}));break}};for(var r in a.vul.param_name)s(r)}catch(o){console.log(o)}l.req_md=i.join("<br/>"),l.res_md=a.vul.response.split("\n").join("<br/>"),l.vulnObj={vul:Object(n["a"])(Object(n["a"])({},a.vul),{},{first_time:Object(d["b"])(a.vul.first_time),latest_time:Object(d["b"])(a.vul.latest_time),graph:a.vul.graph}),server:Object(n["a"])({},a.server),strategy:Object(n["a"])({},a.strategy)}}));case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"vulnDelete",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.vuln.vulnDelete(this.selectedId);case 3:t=e.sent,a=t.status,i=t.msg,this.loadingDone(),201!==a?this.$message({type:"error",message:i,showClose:!0}):(this.$message({type:"success",message:i,showClose:!0}),this.$router.push("/vuln/vulnList"));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"tableRowClassName",value:function(){return"diy-row"}},{key:"cardRowClassName",value:function(e,t){var a="";return e?a="selected":t%2===0&&(a="card-gap"),a}},{key:"exportVul",value:function(){var e=this,t=this.vulnObj.vul.project_name;h["a"].get("project/export?pname=".concat(t,"&vid=").concat(this.selectedId),{responseType:"blob"}).then((function(a){if("application/json"===a.type)e.$message.error({message:e.$t("views.vulnDetail.exportFail"),showClose:!0});else{var i=new Blob([a],{type:"application/octet-stream"}),s=document.createElement("a");s.href=window.URL.createObjectURL(i),s.download=t+".doc",s.click(),e.$message.success({message:e.$t("views.vulnDetail.exportSuccess"),showClose:!0})}})).catch((function(t){e.$message.error({message:e.$t("views.vulnDetail.exportFail"),showClose:!0})}))}},{key:"recheckVul",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={ids:this.selectedId.toString()},e.next=3,this.services.vuln.vulRecheck(t);case 3:a=e.sent,i=a.status,a.data,s=a.msg,201!==i?this.$message({type:"error",message:s,showClose:!0}):this.$message({type:"success",message:s,showClose:!0});case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(f["a"]);m=Object(v["b"])([Object(p["a"])({name:"VulnDetail"})],m);var y=m,_=y,w=(a("a426"),a("3a43"),a("2877")),C=Object(w["a"])(_,i,s,!1,null,"6103ca02",null);t["default"]=C.exports},"3a43":function(e,t,a){"use strict";a("51e0")},"3cde":function(e,t,a){},4127:function(e,t,a){"use strict";var i=a("d233"),s=a("b313"),n={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},l=Date.prototype.toISOString,r={delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,serializeDate:function(e){return l.call(e)},skipNulls:!1,strictNullHandling:!1},o=function e(t,a,s,n,l,o,c,u,v,p,d,f){var h=t;if("function"===typeof c)h=c(a,h);else if(h instanceof Date)h=p(h);else if(null===h){if(n)return o&&!f?o(a,r.encoder):a;h=""}if("string"===typeof h||"number"===typeof h||"boolean"===typeof h||i.isBuffer(h)){if(o){var g=f?a:o(a,r.encoder);return[d(g)+"="+d(o(h,r.encoder))]}return[d(a)+"="+d(String(h))]}var b,m=[];if("undefined"===typeof h)return m;if(Array.isArray(c))b=c;else{var y=Object.keys(h);b=u?y.sort(u):y}for(var _=0;_<b.length;++_){var w=b[_];l&&null===h[w]||(m=Array.isArray(h)?m.concat(e(h[w],s(a,w),s,n,l,o,c,u,v,p,d,f)):m.concat(e(h[w],a+(v?"."+w:"["+w+"]"),s,n,l,o,c,u,v,p,d,f)))}return m};e.exports=function(e,t){var a=e,l=t?i.assign({},t):{};if(null!==l.encoder&&void 0!==l.encoder&&"function"!==typeof l.encoder)throw new TypeError("Encoder has to be a function.");var c="undefined"===typeof l.delimiter?r.delimiter:l.delimiter,u="boolean"===typeof l.strictNullHandling?l.strictNullHandling:r.strictNullHandling,v="boolean"===typeof l.skipNulls?l.skipNulls:r.skipNulls,p="boolean"===typeof l.encode?l.encode:r.encode,d="function"===typeof l.encoder?l.encoder:r.encoder,f="function"===typeof l.sort?l.sort:null,h="undefined"!==typeof l.allowDots&&l.allowDots,g="function"===typeof l.serializeDate?l.serializeDate:r.serializeDate,b="boolean"===typeof l.encodeValuesOnly?l.encodeValuesOnly:r.encodeValuesOnly;if("undefined"===typeof l.format)l.format=s["default"];else if(!Object.prototype.hasOwnProperty.call(s.formatters,l.format))throw new TypeError("Unknown format option provided.");var m,y,_=s.formatters[l.format];"function"===typeof l.filter?(y=l.filter,a=y("",a)):Array.isArray(l.filter)&&(y=l.filter,m=y);var w,C=[];if("object"!==typeof a||null===a)return"";w=l.arrayFormat in n?l.arrayFormat:"indices"in l?l.indices?"indices":"repeat":"indices";var j=n[w];m||(m=Object.keys(a)),f&&m.sort(f);for(var O=0;O<m.length;++O){var x=m[O];v&&null===a[x]||(C=C.concat(o(a[x],x,j,u,v,p?d:null,y,f,h,g,_,b)))}var D=C.join(c),k=!0===l.addQueryPrefix?"?":"";return D.length>0?k+D:""}},4328:function(e,t,a){"use strict";var i=a("4127"),s=a("9e6a"),n=a("b313");e.exports={formats:n,parse:s,stringify:i}},"51e0":function(e,t,a){},"9e6a":function(e,t,a){"use strict";var i=a("d233"),s=Object.prototype.hasOwnProperty,n={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:i.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},l=function(e,t){for(var a={},i=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,l=t.parameterLimit===1/0?void 0:t.parameterLimit,r=i.split(t.delimiter,l),o=0;o<r.length;++o){var c,u,v=r[o],p=v.indexOf("]="),d=-1===p?v.indexOf("="):p+1;-1===d?(c=t.decoder(v,n.decoder),u=t.strictNullHandling?null:""):(c=t.decoder(v.slice(0,d),n.decoder),u=t.decoder(v.slice(d+1),n.decoder)),s.call(a,c)?a[c]=[].concat(a[c]).concat(u):a[c]=u}return a},r=function(e,t,a){for(var i=t,s=e.length-1;s>=0;--s){var n,l=e[s];if("[]"===l)n=[],n=n.concat(i);else{n=a.plainObjects?Object.create(null):{};var r="["===l.charAt(0)&&"]"===l.charAt(l.length-1)?l.slice(1,-1):l,o=parseInt(r,10);!isNaN(o)&&l!==r&&String(o)===r&&o>=0&&a.parseArrays&&o<=a.arrayLimit?(n=[],n[o]=i):n[r]=i}i=n}return i},o=function(e,t,a){if(e){var i=a.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,n=/(\[[^[\]]*])/,l=/(\[[^[\]]*])/g,o=n.exec(i),c=o?i.slice(0,o.index):i,u=[];if(c){if(!a.plainObjects&&s.call(Object.prototype,c)&&!a.allowPrototypes)return;u.push(c)}var v=0;while(null!==(o=l.exec(i))&&v<a.depth){if(v+=1,!a.plainObjects&&s.call(Object.prototype,o[1].slice(1,-1))&&!a.allowPrototypes)return;u.push(o[1])}return o&&u.push("["+i.slice(o.index)+"]"),r(u,t,a)}};e.exports=function(e,t){var a=t?i.assign({},t):{};if(null!==a.decoder&&void 0!==a.decoder&&"function"!==typeof a.decoder)throw new TypeError("Decoder has to be a function.");if(a.ignoreQueryPrefix=!0===a.ignoreQueryPrefix,a.delimiter="string"===typeof a.delimiter||i.isRegExp(a.delimiter)?a.delimiter:n.delimiter,a.depth="number"===typeof a.depth?a.depth:n.depth,a.arrayLimit="number"===typeof a.arrayLimit?a.arrayLimit:n.arrayLimit,a.parseArrays=!1!==a.parseArrays,a.decoder="function"===typeof a.decoder?a.decoder:n.decoder,a.allowDots="boolean"===typeof a.allowDots?a.allowDots:n.allowDots,a.plainObjects="boolean"===typeof a.plainObjects?a.plainObjects:n.plainObjects,a.allowPrototypes="boolean"===typeof a.allowPrototypes?a.allowPrototypes:n.allowPrototypes,a.parameterLimit="number"===typeof a.parameterLimit?a.parameterLimit:n.parameterLimit,a.strictNullHandling="boolean"===typeof a.strictNullHandling?a.strictNullHandling:n.strictNullHandling,""===e||null===e||"undefined"===typeof e)return a.plainObjects?Object.create(null):{};for(var s="string"===typeof e?l(e,a):e,r=a.plainObjects?Object.create(null):{},c=Object.keys(s),u=0;u<c.length;++u){var v=c[u],p=o(v,s[v],a);r=i.merge(r,p,a)}return i.compact(r)}},a15b:function(e,t,a){"use strict";var i=a("23e7"),s=a("44ad"),n=a("fc6a"),l=a("a640"),r=[].join,o=s!=Object,c=l("join",",");i({target:"Array",proto:!0,forced:o||!c},{join:function(e){return r.call(n(this),void 0===e?",":e)}})},a426:function(e,t,a){"use strict";a("3cde")},b313:function(e,t,a){"use strict";var i=String.prototype.replace,s=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return i.call(e,s,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},d233:function(e,t,a){"use strict";var i=Object.prototype.hasOwnProperty,s=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),n=function(e){var t;while(e.length){var a=e.pop();if(t=a.obj[a.prop],Array.isArray(t)){for(var i=[],s=0;s<t.length;++s)"undefined"!==typeof t[s]&&i.push(t[s]);a.obj[a.prop]=i}}return t},l=function(e,t){for(var a=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)"undefined"!==typeof e[i]&&(a[i]=e[i]);return a},r=function e(t,a,s){if(!a)return t;if("object"!==typeof a){if(Array.isArray(t))t.push(a);else{if("object"!==typeof t)return[t,a];(s.plainObjects||s.allowPrototypes||!i.call(Object.prototype,a))&&(t[a]=!0)}return t}if("object"!==typeof t)return[t].concat(a);var n=t;return Array.isArray(t)&&!Array.isArray(a)&&(n=l(t,s)),Array.isArray(t)&&Array.isArray(a)?(a.forEach((function(a,n){i.call(t,n)?t[n]&&"object"===typeof t[n]?t[n]=e(t[n],a,s):t.push(a):t[n]=a})),t):Object.keys(a).reduce((function(t,n){var l=a[n];return i.call(t,n)?t[n]=e(t[n],l,s):t[n]=l,t}),n)},o=function(e,t){return Object.keys(t).reduce((function(e,a){return e[a]=t[a],e}),e)},c=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},u=function(e){if(0===e.length)return e;for(var t="string"===typeof e?e:String(e),a="",i=0;i<t.length;++i){var n=t.charCodeAt(i);45===n||46===n||95===n||126===n||n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122?a+=t.charAt(i):n<128?a+=s[n]:n<2048?a+=s[192|n>>6]+s[128|63&n]:n<55296||n>=57344?a+=s[224|n>>12]+s[128|n>>6&63]+s[128|63&n]:(i+=1,n=65536+((1023&n)<<10|1023&t.charCodeAt(i)),a+=s[240|n>>18]+s[128|n>>12&63]+s[128|n>>6&63]+s[128|63&n])}return a},v=function(e){for(var t=[{obj:{o:e},prop:"o"}],a=[],i=0;i<t.length;++i)for(var s=t[i],l=s.obj[s.prop],r=Object.keys(l),o=0;o<r.length;++o){var c=r[o],u=l[c];"object"===typeof u&&null!==u&&-1===a.indexOf(u)&&(t.push({obj:l,prop:c}),a.push(u))}return n(t)},p=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},d=function(e){return null!==e&&"undefined"!==typeof e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))};e.exports={arrayToObject:l,assign:o,compact:v,decode:c,encode:u,isBuffer:d,isRegExp:p,merge:r}},d58f:function(e,t,a){var i=a("1c0b"),s=a("7b0b"),n=a("44ad"),l=a("50c4"),r=function(e){return function(t,a,r,o){i(a);var c=s(t),u=n(c),v=l(c.length),p=e?v-1:0,d=e?-1:1;if(r<2)while(1){if(p in u){o=u[p],p+=d;break}if(p+=d,e?p<0:v<=p)throw TypeError("Reduce of empty array with no initial value")}for(;e?p>=0:v>p;p+=d)p in u&&(o=a(o,u[p],p,c));return o}};e.exports={left:r(!1),right:r(!0)}}}]);
//# sourceMappingURL=chunk-2178baff.82cea2ad.js.map