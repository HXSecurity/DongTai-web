(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d6d7504"],{"0ccf":function(e,t,a){},1276:function(e,t,a){"use strict";var n=a("2ba4"),r=a("c65b"),s=a("e330"),o=a("d784"),i=a("44e7"),l=a("825a"),u=a("1d80"),c=a("4840"),h=a("8aa5"),g=a("50c4"),p=a("577e"),v=a("dc4a"),k=a("4dae"),d=a("14c3"),m=a("9263"),f=a("9f7f"),b=a("d039"),y=f.UNSUPPORTED_Y,w=4294967295,_=Math.min,P=[].push,$=s(/./.exec),x=s(P),T=s("".slice),S=!b((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var a="ab".split(e);return 2!==a.length||"a"!==a[0]||"b"!==a[1]}));o("split",(function(e,t,a){var s;return s="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,a){var s=p(u(this)),o=void 0===a?w:a>>>0;if(0===o)return[];if(void 0===e)return[s];if(!i(e))return r(t,s,e,o);var l,c,h,g=[],v=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,f=new RegExp(e.source,v+"g");while(l=r(m,f,s)){if(c=f.lastIndex,c>d&&(x(g,T(s,d,l.index)),l.length>1&&l.index<s.length&&n(P,g,k(l,1)),h=l[0].length,d=c,g.length>=o))break;f.lastIndex===l.index&&f.lastIndex++}return d===s.length?!h&&$(f,"")||x(g,""):x(g,T(s,d)),g.length>o?k(g,0,o):g}:"0".split(void 0,0).length?function(e,a){return void 0===e&&0===a?[]:r(t,this,e,a)}:t,[function(t,a){var n=u(this),o=void 0==t?void 0:v(t,e);return o?r(o,t,n,a):r(s,p(n),t,a)},function(e,n){var r=l(this),o=p(e),i=a(s,r,o,n,s!==t);if(i.done)return i.value;var u=c(r,RegExp),v=r.unicode,k=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(y?"g":"y"),m=new u(y?"^(?:"+r.source+")":r,k),f=void 0===n?w:n>>>0;if(0===f)return[];if(0===o.length)return null===d(m,o)?[o]:[];var b=0,P=0,$=[];while(P<o.length){m.lastIndex=y?0:P;var S,C=d(m,y?T(o,P):o);if(null===C||(S=_(g(m.lastIndex+(y?P:0)),o.length))===b)P=h(o,P,v);else{if(x($,T(o,b,P)),$.length===f)return $;for(var O=1;O<=C.length-1;O++)if(x($,C[O]),$.length===f)return $;P=b=S}}return x($,T(o,b)),$}]}),!S,y)},"1f58":function(e,t,a){"use strict";a("0ccf")},"55d4":function(e,t,a){},"55fe":function(e,t,a){},"5dd6":function(e,t,a){},"743c":function(e,t,a){},"7a05":function(e,t,a){"use strict";a("5dd6")},"82c0":function(e,t,a){"use strict";a("55d4")},"8b45":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"hook-rule"},[a("div",{staticClass:"top-bar"},[a("div",{staticClass:"top-info"},[a("div",{staticClass:"column"},[a("span",{staticClass:"top-title"},[e._v(e._s(e.$t("views.hookPage.allHooksNum"))+":")]),a("span",{staticClass:"bottom-info"},[e._v(e._s(e.base.ruleCount))]),e._v(" "+e._s(e.$t("views.hookPage.strip"))+" ")]),a("div",{staticClass:"column"},[a("span",{staticClass:"top-title"},[e._v(e._s(e.$t("views.hookPage.hooksType"))+":")]),a("span",{staticClass:"bottom-info"},[e._v(e._s(e.base.typeCount))]),e._v(" "+e._s(e.$t("views.hookPage.race"))+" ")]),a("div",{staticClass:"column"},[a("span",{staticClass:"top-title"},[e._v(e._s(e.$t("views.hookPage.sinkHooksNum"))+":")]),a("span",{staticClass:"bottom-info"},[e._v(e._s(e.base.sinkCount))]),e._v(" "+e._s(e.$t("views.hookPage.strip"))+" ")])]),a("div",{staticClass:"top-select"},e._l(e.languageOptions,(function(t){return a("div",{key:t.id,class:e.activeLanguage===t.id&&"active",on:{click:function(a){e.activeLanguage!==t.id&&e.changeLanguage(t)}}},[e._v(" "+e._s(t.name)+" ")])})),0)]),a("div",{staticClass:"info-body"},[e.reflash?a("el-tabs",{staticClass:"info-tabs",model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[a("el-tab-pane",{staticClass:"info-tab",attrs:{label:e.$t("views.hookPage.sourceRule"),name:"2"}},["2"===e.type?a("HookTable",{attrs:{"get-base":e.getBase,"active-language":e.activeLanguage,"active-language-name":e.activeLanguageName,"rule-type":e.type}}):e._e()],1),a("el-tab-pane",{staticClass:"info-tab",attrs:{label:e.$t("views.hookPage.propRule"),name:"1"}},["1"===e.type?a("HookTable",{attrs:{"get-base":e.getBase,"active-language":e.activeLanguage,"active-language-name":e.activeLanguageName,"rule-type":e.type}}):e._e()],1),a("el-tab-pane",{staticClass:"info-tab",attrs:{label:e.$t("views.hookPage.filterRule"),name:"3"}},["3"===e.type?a("HookTable",{attrs:{"get-base":e.getBase,"active-language":e.activeLanguage,"active-language-name":e.activeLanguageName,"rule-type":e.type}}):e._e()],1),a("el-tab-pane",{staticClass:"info-tab",attrs:{label:e.$t("views.hookPage.dangerRule"),name:"4"}},["4"===e.type?a("DangerTable",{attrs:{"get-base":e.getBase,"active-language":e.activeLanguage,"active-language-name":e.activeLanguageName,"rule-type":e.type}}):e._e()],1),a("el-tab-pane",{staticClass:"info-tab",attrs:{label:"主动验证",name:"5"}},["5"===e.type?a("VulnTable",{attrs:{"get-base":e.getBase,"active-language":e.activeLanguage,"active-language-name":e.activeLanguageName,"rule-type":e.type}}):e._e()],1)],1):e._e()],1)])},r=[],s=a("1da1"),o=a("d4ec"),i=a("bee2"),l=a("262e"),u=a("2caf"),c=(a("96cf"),a("b0c0"),a("9ab4")),h=a("60a3"),g=a("8c73"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-body"},[a("div",{staticClass:"flex-between"},[a("div",{style:{display:"flex",flex:1}},[a("el-select",{staticClass:"search-input",attrs:{size:"small",placeholder:e.$t("views.hookPage.selectType"),filterable:"",clearab:""},on:{change:function(t){return e.handleCurrentChange(1)}},model:{value:e.rule_type,callback:function(t){e.rule_type=t},expression:"rule_type"}},e._l(e.types,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-input",{staticClass:"search-input",staticStyle:{width:"260px"},attrs:{size:"small",placeholder:e.$t("views.hookPage.searchDesc")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleCurrentChange(1)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.handleCurrentChange(1)}},slot:"append"})],1)],1),a("div",[a("el-button",{staticClass:"resetAllBtn",staticStyle:{visibility:"hidden"},attrs:{size:"small"},on:{click:function(t){e.hookTypeDialog=!0}}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "+e._s(e.$t("views.hookPage.addHookType")))]),a("el-button",{staticClass:"resetAllBtn",attrs:{size:"small"},on:{click:function(t){e.hookDialog=!0}}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "+e._s(e.$t("views.hookPage.addHook")))])],1)]),a("div",{staticClass:"btn-list-batch"},[a("span",{staticStyle:{color:"#38435a"}},[e._v(" "+e._s(e.$t("views.hookPage.selected"))+" "),a("span",{staticStyle:{color:"#4a72ae"}},[e._v(e._s(e.multipleSelection.length)+" ")]),e._v(e._s(e.$t("views.hookPage.strip"))+" ")]),a("div",[a("el-button",{staticClass:"resetAllBtn open",attrs:{size:"small"},on:{click:function(t){return e.changeStatusBatch("enable")}}},[e._v(e._s(e.multipleSelection.length?"":e.$t("views.hookPage.all"))+e._s(e.$t("views.hookPage.on")))]),a("el-button",{staticClass:"resetAllBtn stop",attrs:{size:"small"},on:{click:function(t){return e.changeStatusBatch("disable")}}},[e._v(e._s(e.multipleSelection.length?"":e.$t("views.hookPage.all"))+e._s(e.$t("views.hookPage.off")))]),a("el-button",{staticClass:"resetAllBtn delete",attrs:{size:"small"},on:{click:function(t){return e.changeStatusBatch("delete")}}},[e._v(e._s(e.multipleSelection.length?"":e.$t("views.hookPage.all"))+e._s(e.$t("views.hookPage.del")))])],1)]),a("el-table",{staticClass:"hookTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","header-row-style":{color:"#000",fontWeight:600}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",fixed:!!e.tableData.length&&"left"}}),a("template",{slot:"empty"},[a("div",{staticClass:"empty-box"},[a("span",[e._v(e._s(e.$t("views.hookPage.empty")))])])]),a("el-table-column",{attrs:{prop:"rule_type",label:e.$t("views.hookPage.hooksType"),width:"180",fixed:!!e.tableData.length&&"left"}}),a("el-table-column",{attrs:{prop:"value",label:e.$t("views.hookPage.ruleInfo"),width:"340"}}),a("el-table-column",{attrs:{prop:"source",label:e.$t("views.hookPage.point"),width:"180"}}),a("el-table-column",{attrs:{prop:"inherit",label:e.$t("views.hookPage.hoopDeep"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("true"===t.row.inherit?e.$t("views.hookPage.children"):"all"===t.row.inherit?e.$t("views.hookPage.nowChildren"):e.$t("views.hookPage.now"))+" ")]}}])}),a("el-table-column",{attrs:{prop:"track",label:e.$t("views.hookPage.openTrace"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("true"===t.row.track?e.$t("views.hookPage.yes"):e.$t("views.hookPage.no"))+" ")]}}])}),a("el-table-column",{attrs:{prop:"update_time",label:e.$t("views.hookPage.updateTime"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatTimestamp")(t.row.update_time))+" ")]}}])}),e.rolesCheck(["system_admin","talent_admin"],!0)?a("el-table-column",{attrs:{prop:"user",label:e.$t("views.hookPage.user"),width:"180"}}):e._e(),a("el-table-column",{attrs:{align:"center","header-align":"center",label:e.$t("views.hookPage.status"),fixed:!!e.tableData.length&&"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#37D7BB","inactive-color":"#D9DDE1","active-value":1,"inactive-value":0},on:{change:function(a){return e.changeStatus(t.row)}},model:{value:t.row.enable,callback:function(a){e.$set(t.row,"enable",a)},expression:"scope.row.enable"}})]}}])}),a("el-table-column",{attrs:{prop:"",label:e.$t("views.hookPage.address"),width:"200",align:"center",fixed:!!e.tableData.length&&"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-btn-box"},[a("el-button",{staticStyle:{color:"#4a72ae"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.editRow(t.row)}}},[e._v(" "+e._s(e.$t("views.hookPage.edit"))+" ")]),a("span",{staticClass:"l"},[e._v(" | ")]),a("el-popconfirm",{attrs:{title:e.$t("views.hookPage.delpop")},on:{confirm:function(a){return e.changeStatus(t.row,"delete")}}},[a("el-button",{staticStyle:{color:"#f56262"},attrs:{slot:"reference",size:"small",type:"text"},slot:"reference"},[e._v(e._s(e.$t("views.hookPage.del")))])],1)],1)]}}])})],2),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,background:"",layout:" prev, pager, next, jumper,total, sizes",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{visible:e.hookTypeDialog},on:{"update:visible":function(t){e.hookTypeDialog=t}}},[a("el-form",{attrs:{model:e.hookType,"label-width":"en"===e.$i18n.locale?"140px":"80px",size:"small"}},[a("el-form-item",{attrs:{label:e.$t("views.hookPage.hookType")}},[a("span",[e._v(e._s(e.fmtType(e.hookType.type)))])]),a("el-form-item",{attrs:{label:"语言"}},[a("span",[e._v(e._s(e.activeLanguageName))])]),a("el-form-item",{attrs:{label:e.$t("views.hookPage.typeName")}},[a("el-input",{attrs:{placeholder:e.$t("views.hookPage.namePlaceholder")},model:{value:e.hookType.name,callback:function(t){e.$set(e.hookType,"name",t)},expression:"hookType.name"}})],1),a("el-form-item",{attrs:{label:e.$t("views.hookPage.typeShotName")}},[a("el-input",{attrs:{placeholder:e.$t("views.hookPage.shotNamePlaceholder")},model:{value:e.hookType.short_name,callback:function(t){e.$set(e.hookType,"short_name",t)},expression:"hookType.short_name"}})],1),a("el-form-item",{attrs:{label:e.$t("views.hookPage.openOrNot")}},[a("el-switch",{attrs:{"active-color":"#37D7BB","inactive-color":"#D9DDE1","active-value":1,"inactive-value":0},model:{value:e.hookType.enable,callback:function(t){e.$set(e.hookType,"enable",t)},expression:"hookType.enable"}})],1)],1),a("template",{slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.clearHookType}},[e._v(e._s(e.$t("views.hookPage.clear")))]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.enterHookType}},[e._v(e._s(e.$t("views.hookPage.enter")))])],1)],2),a("el-dialog",{attrs:{visible:e.hookDialog},on:{"update:visible":function(t){e.hookDialog=t}}},[a("el-form",{attrs:{model:e.hook,size:"small","label-width":"en"===e.$i18n.locale?"140px":"80px"}},[a("el-form-item",{attrs:{label:e.$t("views.hookPage.hookType")}},[a("span",[e._v(e._s(e.fmtType(e.hook.type)))])]),a("el-form-item",{attrs:{label:e.$t("views.hookPage.hooksType")}},[a("el-select",{attrs:{placeholder:e.$t("views.hookPage.namePlaceholder")},model:{value:e.hook.rule_type_id,callback:function(t){e.$set(e.hook,"rule_type_id",t)},expression:"hook.rule_type_id"}},e._l(e.types,(function(e){return a("el-option",{key:e.id,staticStyle:{width:"100%"},attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("views.hookPage.ruleInfo")}},[a("el-input",{attrs:{placeholder:e.$t("views.hookPage.ruleInfoPlaceholder")},model:{value:e.hook.rule_value,callback:function(t){e.$set(e.hook,"rule_value",t)},expression:"hook.rule_value"}})],1),e._l(e.hook.source,(function(t,n){return[a("el-form-item",{key:"source"+n,attrs:{label:0===n?e.$t("views.hookPage.source"):""}},[n>0?a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:e.$t("views.hookPage.relation")},model:{value:t.relation,callback:function(a){e.$set(t,"relation",a)},expression:"item.relation"}},e._l(e.relations,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:e.$t("views.hookPage.origin")},on:{change:function(a){return e.changeOrigin(t)}},model:{value:t.origin,callback:function(a){e.$set(t,"origin",a)},expression:"item.origin"}},e._l(e.origins,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:"O"===t.value&&e.hook.source.some((function(e){return"O"===e.origin}))||"R"===t.value&&e.hook.source.some((function(e){return"R"===e.origin}))}})})),1),"P"===t.origin?a("el-input",{staticStyle:{width:"10%","margin-left":"10px"},attrs:{placeholder:e.$t("views.hookPage.paramPlaceholder")},model:{value:t.param,callback:function(a){e.$set(t,"param",a)},expression:"item.param"}}):e._e(),a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.addSource(e.hook.source)}}},[e._v(e._s(e.$t("views.hookPage.add")))]),e.hook.source.length>1?a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.deleteSource(e.hook.source,n)}}},[e._v(e._s(e.$t("views.hookPage.del")))]):e._e()],1)],1)]})),a("el-form-item",{attrs:{label:e.$t("views.hookPage.track")}},[a("el-radio",{attrs:{label:"true"},model:{value:e.hook.track,callback:function(t){e.$set(e.hook,"track",t)},expression:"hook.track"}},[e._v(e._s(e.$t("views.hookPage.on")))]),a("el-radio",{attrs:{label:"false"},model:{value:e.hook.track,callback:function(t){e.$set(e.hook,"track",t)},expression:"hook.track"}},[e._v(e._s(e.$t("views.hookPage.off")))])],1),a("el-form-item",{attrs:{label:e.$t("views.hookPage.depth")}},[a("el-radio",{attrs:{label:"false"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v(e._s(e.$t("views.hookPage.onlyNow")))]),a("el-radio",{attrs:{label:"true"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v(e._s(e.$t("views.hookPage.onlyChildren")))]),a("el-radio",{attrs:{label:"all"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v(e._s(e.$t("views.hookPage.nowChildren")))])],1)],2),a("template",{slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.clearHook}},[e._v(e._s(e.$t("views.hookPage.clear")))]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.enterHook}},[e._v(e._s(e.$t("views.hookPage.enter")))])],1)],2)],1)},v=[],k=a("2909"),d=(a("99af"),a("d81d"),a("ac1f"),a("1276"),a("a434"),a("d3b7"),a("159b"),a("fb6a"),a("a9e3"),a("73ec")),m=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.keyword="",e.hookTypeDialog=!1,e.hookDialog=!1,e.rule_type="",e.hookType={type:"1",name:"",short_name:"",enable:1,language_id:e.activeLanguage},e.types=[],e.hook={id:0,type:"1",rule_type_id:"",rule_value:"",source:[{relation:"",origin:"",param:""}],inherit:"false",track:"true"},e.relations=[{label:e.$t("views.hookPage.or"),value:"|"},{label:e.$t("views.hookPage.and"),value:"&"}],e.origins=[{label:e.$t("views.hookPage.O"),value:"O"},{label:e.$t("views.hookPage.R"),value:"R"},{label:e.$t("views.hookPage.P"),value:"P"}],e.tableData=[],e.pageSize=20,e.currentPage=1,e.total=0,e.multipleSelection=[],e}return Object(i["a"])(a,[{key:"handleSelectionChange",value:function(e){this.multipleSelection=e}},{key:"changeStatusBatch",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a="",e.t0=t,e.next="delete"===e.t0?4:"enable"===e.t0?6:"disable"===e.t0?8:10;break;case 4:return a=this.$t("views.hookPage.del"),e.abrupt("break",10);case 6:return a=this.$t("views.hookPage.on"),e.abrupt("break",10);case 8:return a=this.$t("views.hookPage.off"),e.abrupt("break",10);case 10:this.$confirm("".concat(this.$t("views.hookPage.changeOne")).concat(a).concat(this.$t("views.hookPage.changeTwo")),this.$t("views.hookPage.pop"),{confirmButtonText:this.$t("views.hookPage.enter"),cancelButtonText:this.$t("views.hookPage.clear"),type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){var a,r,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==n.multipleSelection.length){e.next=3;break}return n.changeStatusAll(t),e.abrupt("return");case 3:return a=n.multipleSelection.map((function(e){return e.id})),e.next=6,n.services.setting.changeStatusBatch({ids:String(a),op:t});case 6:if(r=e.sent,s=r.status,o=r.msg,201===s){e.next=12;break}return n.$message({type:"error",message:o,showClose:!0}),e.abrupt("return");case 12:return n.$message({type:"success",message:o,showClose:!0}),e.next=15,n.getBase();case 15:return e.next=17,n.getTable();case 17:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e)}));case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"splitAndIn",value:function(e,t){for(var a=e.split(t),n=0;n<a.length;n++)n%2!=0&&(a.splice(n,0,t),n++);return a}},{key:"makeParamsArr",value:function(e){function t(e,t){var a=[];if("P"===e[0]){var n=e.substring(1,e.length),r=n.split(",");r.forEach((function(e){a.some((function(e){return"P"===e.origin}))?a.push({relation:"&",origin:"P",param:e}):a.push({relation:t,origin:"P",param:e})}))}else a.push({relation:t,origin:e,param:""});return a}function a(e){var a=[];return 1==e.length?a.push.apply(a,Object(k["a"])(t(e[0],""))):a.push.apply(a,Object(k["a"])(t(e[1],e[0]))),a}for(var n=[],r=[],s=0,o=0;o<e.length;o++)"|"!=e[o]&&"&"!=e[o]||(n.push(e.slice(s,o)),s=o),o==e.length-1&&n.push(e.slice(s,e.length));for(var i=0;i<n.length;i++)r.push.apply(r,Object(k["a"])(a(n[i])));return r}},{key:"editRow",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a=this.splitAndIn(t.source,"|"),n=0;n<a.length;n++)a[n].indexOf("&")>-1&&(r=this.splitAndIn(a[n],"&"),a.splice.apply(a,[n,1].concat(Object(k["a"])(r))),n+=r.length);s=this.makeParamsArr(a),this.hook.rule_value=t.value,this.hook.id=t.id,this.hook.inherit=t.inherit,this.hook.source=s,this.hook.rule_type_id=t.rule_type_id,this.hookDialog=!0;case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTypes",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleTypes({type:this.ruleType,language_id:this.activeLanguage});case 3:if(t=e.sent,a=t.status,n=t.msg,r=t.data,this.loadingDone(),201===a){e.next=11;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 11:this.types=r;case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"addSource",value:function(e){e.push({relation:"",origin:"",param:""})}},{key:"deleteSource",value:function(e,t){e.splice(t,1),e[0].relation=""}},{key:"changeOrigin",value:function(e){"P"!==e.origin&&(e.param="")}},{key:"deleteRule",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleDelete({rule_id:t.id});case 3:if(a=e.sent,n=a.status,r=a.msg,this.loadingDone(),t.visible=!1,201===n){e.next=11;break}return this.$message({type:"error",message:r,showClose:!0}),e.abrupt("return");case 11:return e.next=13,this.getTable();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeStatusAll",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.changeStatus({scope:"all",op:t,language_id:this.activeLanguage,hook_rule_type:this.ruleType});case 3:if(a=e.sent,this.loadingDone(),201===a.status){e.next=8;break}return this.$message({showClose:!0,message:a.msg,type:"error"}),e.abrupt("return");case 8:return this.$message({showClose:!0,message:a.msg,type:"success"}),this.currentPage=1,e.next=12,this.getBase();case 12:return e.next=14,this.getTable();case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeStatus",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:"",this.loadingStart(),e.next=4,this.services.setting.changeStatus({rule_id:t.id,op:a||(0===t.enable?"disable":"enable")});case 4:if(n=e.sent,this.loadingDone(),201===n.status){e.next=9;break}return this.$message({showClose:!0,message:n.msg,type:"error"}),e.abrupt("return");case 9:return e.next=11,this.getBase();case 11:return e.next=13,this.getTable();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"clearHookType",value:function(){this.hookType={type:this.ruleType,name:"",language_id:this.activeLanguage,short_name:"",enable:0},this.hookTypeDialog=!1}},{key:"enterHookType",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleTypeAdd(this.hookType);case 3:if(t=e.sent,a=t.status,n=t.msg,this.loadingDone(),201===a){e.next=11;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 11:return e.next=14,this.getTypes();case 14:this.clearHookType();case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"fmtType",value:function(e){switch(e){case"1":return this.$t("views.hookPage.spreadType");case"2":return this.$t("views.hookPage.contaminatedType");case"3":return this.$t("views.hookPage.filterType");case"4":return this.$t("views.hookPage.dangerType");case"5":return this.$t("views.hookPage.enterType")}}},{key:"clearHook",value:function(){this.hook={id:0,type:this.ruleType,rule_type_id:"",rule_value:"",source:[{relation:"",origin:"",param:""}],inherit:"false",track:"true"},this.hookDialog=!1}},{key:"fmtParams",value:function(e){var t="",a="";return e.forEach((function(e){"P"!==e.origin||t?"P"===e.origin&&t?t+=",".concat(e.param):a+="".concat(e.relation).concat(e.origin):t+="".concat(e.relation).concat(e.origin).concat(e.param)})),a+t}},{key:"enterHook",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,s,o,i,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.hook.id){e.next=17;break}return this.loadingStart(),t=this.fmtParams(this.hook.source),e.next=5,this.services.setting.modifyAdd({rule_id:this.hook.id,rule_type_id:this.hook.rule_type_id,rule_value:this.hook.rule_value,rule_source:t,rule_target:"",inherit:this.hook.inherit,track:this.hook.track});case 5:if(a=e.sent,n=a.status,r=a.msg,this.loadingDone(),201===n){e.next=12;break}return this.$message({type:"error",message:r,showClose:!0}),e.abrupt("return");case 12:return e.next=14,this.getTable();case 14:this.clearHook(),e.next=33;break;case 17:return this.loadingStart(),s=this.fmtParams(this.hook.source),e.next=21,this.services.setting.ruleAdd({rule_type_id:this.hook.rule_type_id,rule_value:this.hook.rule_value,rule_source:s,rule_target:"",inherit:this.hook.inherit,track:this.hook.track});case 21:if(o=e.sent,i=o.status,l=o.msg,this.loadingDone(),201===i){e.next=28;break}return this.$message({type:"error",message:l,showClose:!0}),e.abrupt("return");case 28:return e.next=30,this.getBase();case 30:return e.next=32,this.getTable();case 32:this.clearHook();case 33:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"changeRuleType",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.currentPage=1,e.next=3,this.getTable();case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getTable",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.hookRuleList({page:this.currentPage,pageSize:this.pageSize,type:this.ruleType,strategy_type:this.rule_type,language_id:this.activeLanguage,keyword:this.keyword});case 3:if(t=e.sent,a=t.status,n=t.msg,r=t.data,s=t.page,this.loadingDone(),201===a){e.next=12;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 12:if(this.total=s.alltotal,!(0===r.length&&this.currentPage>1)){e.next=18;break}return this.currentPage--,e.next=17,this.getTable();case 17:return e.abrupt("return");case 18:this.tableData=r;case 19:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(e){this.pageSize=e,this.currentPage=1,this.getTable()}},{key:"handleCurrentChange",value:function(e){this.currentPage=e,this.getTable()}},{key:"created",value:function(){this.hookType.type=this.ruleType,this.hook.type=this.ruleType,this.getTable(),this.getTypes()}}]),a}(g["a"]);Object(c["b"])([Object(h["c"])({default:"0",type:String})],m.prototype,"ruleType",void 0),Object(c["b"])([Object(h["c"])({default:1,type:Number})],m.prototype,"activeLanguage",void 0),Object(c["b"])([Object(h["c"])({default:"",type:String})],m.prototype,"activeLanguageName",void 0),Object(c["b"])([Object(h["c"])({default:function(){return!0},type:Function})],m.prototype,"getBase",void 0),m=Object(c["b"])([Object(h["a"])({name:"HookTable",filters:{formatTimestamp:function(e){return Object(d["a"])(e)}}})],m);var f=m,b=f,y=(a("7a05"),a("2877")),w=Object(y["a"])(b,p,v,!1,null,"bf1937fc",null),_=w.exports,P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-body"},[a("div",{staticClass:"flex-between"},[a("div",{style:{display:"flex",flex:1}},[a("el-select",{staticClass:"search-input",attrs:{size:"small",placeholder:e.$t("views.hookPage.selectType"),filterable:"",clearable:""},on:{change:function(t){return e.handleCurrentChange(1)}},model:{value:e.rule_type,callback:function(t){e.rule_type=t},expression:"rule_type"}},e._l(e.types,(function(e){return a("el-option",{key:e.id,attrs:{label:e.vul_name,value:e.id}})})),1),a("el-input",{staticClass:"search-input",staticStyle:{width:"260px"},attrs:{size:"small",placeholder:e.$t("views.hookPage.searchDesc")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleCurrentChange(1)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.handleCurrentChange(1)}},slot:"append"})],1)],1),a("div",[a("el-button",{staticClass:"resetAllBtn",staticStyle:{visibility:"hidden"},attrs:{size:"small"},on:{click:function(t){e.hookTypeDialog=!0}}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "+e._s(e.$t("views.hookPage.addHookType")))]),a("el-button",{staticClass:"resetAllBtn",attrs:{size:"small"},on:{click:function(t){e.hookDialog=!0}}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "+e._s(e.$t("views.hookPage.addHook")))])],1)]),a("div",{staticClass:"btn-list-batch"},[a("span",{staticStyle:{color:"#38435a"}},[e._v(" "+e._s(e.$t("views.hookPage.selected"))+" "),a("span",{staticStyle:{color:"#4a72ae"}},[e._v(e._s(e.multipleSelection.length)+" ")]),e._v(e._s(e.$t("views.hookPage.strip"))+" ")]),a("div",[a("el-button",{staticClass:"resetAllBtn open",attrs:{size:"small"},on:{click:function(t){return e.changeStatusBatch(1)}}},[e._v(e._s(e.multipleSelection.length?"":e.$t("views.hookPage.all"))+e._s(e.$t("views.hookPage.on")))]),a("el-button",{staticClass:"resetAllBtn stop",attrs:{size:"small"},on:{click:function(t){return e.changeStatusBatch(0)}}},[e._v(e._s(e.multipleSelection.length?"":e.$t("views.hookPage.all"))+e._s(e.$t("views.hookPage.off")))]),a("el-button",{staticClass:"resetAllBtn delete",attrs:{size:"small"},on:{click:function(t){return e.changeStatusBatch(-1)}}},[e._v(e._s(e.multipleSelection.length?"":e.$t("views.hookPage.all"))+e._s(e.$t("views.hookPage.del")))])],1)]),a("el-table",{staticClass:"hookTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","header-row-style":{color:"#000",fontWeight:600}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",fixed:!!e.tableData.length&&"left"}}),a("template",{slot:"empty"},[a("div",{staticClass:"empty-box"},[a("span",[e._v(e._s(e.$t("views.hookPage.empty")))])])]),a("el-table-column",{attrs:{prop:"strategy__vul_name",label:e.$t("views.hookPage.hooksType"),width:"180",fixed:!!e.tableData.length&&"left"}}),a("el-table-column",{attrs:{prop:"value",label:e.$t("views.hookPage.ruleInfo"),width:"240"}}),a("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatTimestamp")(t.row.create_time))+" ")]}}])}),a("el-table-column",{attrs:{prop:"user__username",label:"创建者",width:"100"}}),a("el-table-column",{attrs:{align:"center","header-align":"center",label:e.$t("views.hookPage.status"),fixed:!!e.tableData.length&&"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#37D7BB","inactive-color":"#D9DDE1","active-value":1,"inactive-value":0},on:{change:function(a){return e.changeStatus(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})]}}])}),a("el-table-column",{attrs:{prop:"",label:e.$t("views.hookPage.address"),width:"200",align:"center",fixed:!!e.tableData.length&&"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-btn-box"},[a("el-button",{staticStyle:{color:"#4a72ae"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.editRow(t.row)}}},[e._v(" "+e._s(e.$t("views.hookPage.edit"))+" ")]),a("span",{staticClass:"l"},[e._v(" | ")]),a("el-popconfirm",{attrs:{title:e.$t("views.hookPage.delpop")},on:{confirm:function(a){return e.deleteVuln(t.row)}}},[a("el-button",{staticStyle:{color:"#f56262"},attrs:{slot:"reference",size:"small",type:"text"},slot:"reference"},[e._v(e._s(e.$t("views.hookPage.del")))])],1)],1)]}}])})],2),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,background:"",layout:" prev, pager, next, jumper,total, sizes",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{visible:e.hookTypeDialog},on:{"update:visible":function(t){e.hookTypeDialog=t}}},[a("el-form",{attrs:{model:e.hookType,"label-width":"en"===e.$i18n.locale?"140px":"80px",size:"small"}},[a("el-form-item",{attrs:{label:e.$t("views.hookPage.hookType")}},[a("span",[e._v(e._s(e.fmtType(e.hookType.type)))])]),a("el-form-item",{attrs:{label:"语言"}},[a("span",[e._v(e._s(e.activeLanguageName))])]),a("el-form-item",{attrs:{label:e.$t("views.hookPage.typeName")}},[a("el-input",{attrs:{placeholder:e.$t("views.hookPage.namePlaceholder")},model:{value:e.hookType.name,callback:function(t){e.$set(e.hookType,"name",t)},expression:"hookType.name"}})],1),a("el-form-item",{attrs:{label:e.$t("views.hookPage.typeShotName")}},[a("el-input",{attrs:{placeholder:e.$t("views.hookPage.shotNamePlaceholder")},model:{value:e.hookType.short_name,callback:function(t){e.$set(e.hookType,"short_name",t)},expression:"hookType.short_name"}})],1),a("el-form-item",{attrs:{label:e.$t("views.hookPage.openOrNot")}},[a("el-switch",{attrs:{"active-color":"#37D7BB","inactive-color":"#D9DDE1","active-value":1,"inactive-value":0},model:{value:e.hookType.enable,callback:function(t){e.$set(e.hookType,"enable",t)},expression:"hookType.enable"}})],1)],1),a("template",{slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.clearHookType}},[e._v(e._s(e.$t("views.hookPage.clear")))]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.enterHookType}},[e._v(e._s(e.$t("views.hookPage.enter")))])],1)],2),a("el-dialog",{attrs:{visible:e.hookDialog},on:{"update:visible":function(t){e.hookDialog=t}}},[a("el-form",{attrs:{model:e.hook,size:"small","label-width":"en"===e.$i18n.locale?"140px":"80px"}},[a("el-form-item",{attrs:{label:e.$t("views.hookPage.hookType")}},[a("span",[e._v(e._s(e.fmtType(e.hook.type)))])]),a("el-form-item",{attrs:{label:e.$t("views.hookPage.hookType")}},[a("el-select",{attrs:{size:"small",placeholder:"请选择规则类型",filterable:"",clearab:""},model:{value:e.hook.strategy_id,callback:function(t){e.$set(e.hook,"strategy_id",t)},expression:"hook.strategy_id"}},e._l(e.types,(function(e){return a("el-option",{key:e.id,attrs:{label:e.vul_name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("views.hookPage.ruleInfo")}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入规则详情，例：'and 1=1"},model:{value:e.hook.value,callback:function(t){e.$set(e.hook,"value",t)},expression:"hook.value"}})],1)],1),a("template",{slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.clearHook}},[e._v(e._s(e.$t("views.hookPage.clear")))]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.enterHook}},[e._v(e._s(e.$t("views.hookPage.enter")))])],1)],2)],1)},$=[],x=a("5530"),T=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.keyword="",e.hookTypeDialog=!1,e.hookDialog=!1,e.rule_type="",e.hookType={type:"1",name:"",short_name:"",enable:1,language_id:e.activeLanguage},e.types=[],e.hook={id:0,strategy_id:"",language_id:e.activeLanguage,value:"",status:1,type:"5"},e.relations=[{label:e.$t("views.hookPage.or"),value:"|"},{label:e.$t("views.hookPage.and"),value:"&"}],e.origins=[{label:e.$t("views.hookPage.O"),value:"O"},{label:e.$t("views.hookPage.R"),value:"R"},{label:e.$t("views.hookPage.P"),value:"P"}],e.tableData=[],e.pageSize=20,e.currentPage=1,e.total=0,e.multipleSelection=[],e}return Object(i["a"])(a,[{key:"handleSelectionChange",value:function(e){this.multipleSelection=e}},{key:"changeStatusBatch",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a="",e.t0=t,e.next=2===e.t0?4:1===e.t0?6:0===e.t0?8:10;break;case 4:return a=this.$t("views.hookPage.del"),e.abrupt("break",10);case 6:return a=this.$t("views.hookPage.on"),e.abrupt("break",10);case 8:return a=this.$t("views.hookPage.off"),e.abrupt("break",10);case 10:this.$confirm("".concat(this.$t("views.hookPage.changeOne")).concat(a).concat(this.$t("views.hookPage.changeTwo")),this.$t("views.hookPage.pop"),{confirmButtonText:this.$t("views.hookPage.enter"),cancelButtonText:this.$t("views.hookPage.clear"),type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){var a,r,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==n.multipleSelection.length){e.next=3;break}return n.changeStatusAll(t),e.abrupt("return");case 3:return a=n.multipleSelection.map((function(e){return e.id})),e.next=6,n.services.setting.changeVulStatus({ids:a,mode:1,status:t});case 6:if(r=e.sent,s=r.status,o=r.msg,201===s){e.next=12;break}return n.$message({type:"error",message:o,showClose:!0}),e.abrupt("return");case 12:return n.$message({type:"success",message:o,showClose:!0}),e.next=15,n.getBase();case 15:return e.next=17,n.getTable();case 17:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e)}));case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"splitAndIn",value:function(e,t){for(var a=e.split(t),n=0;n<a.length;n++)n%2!=0&&(a.splice(n,0,t),n++);return a}},{key:"makeParamsArr",value:function(e){function t(e,t){var a=[];if("P"===e[0]){var n=e.substring(1,e.length),r=n.split(",");r.forEach((function(e){a.some((function(e){return"P"===e.origin}))?a.push({relation:"&",origin:"P",param:e}):a.push({relation:t,origin:"P",param:e})}))}else a.push({relation:t,origin:e,param:""});return a}function a(e){var a=[];return 1==e.length?a.push.apply(a,Object(k["a"])(t(e[0],""))):a.push.apply(a,Object(k["a"])(t(e[1],e[0]))),a}for(var n=[],r=[],s=0,o=0;o<e.length;o++)"|"!=e[o]&&"&"!=e[o]||(n.push(e.slice(s,o)),s=o),o==e.length-1&&n.push(e.slice(s,e.length));for(var i=0;i<n.length;i++)r.push.apply(r,Object(k["a"])(a(n[i])));return r}},{key:"editRow",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.hook.strategy_id=t.strategy_id,this.hook.id=t.id,this.hook.language_id=t.language_id,this.hook.value=t.value,this.hook.type="5",this.hook.status=t.status,this.hookDialog=!0;case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTypes",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.strategyList(!0,{});case 3:if(t=e.sent,a=t.status,n=t.msg,r=t.data,this.loadingDone(),201===a){e.next=11;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 11:this.types=r;case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"addSource",value:function(e){e.push({relation:"",origin:"",param:""})}},{key:"deleteSource",value:function(e,t){e.splice(t,1),e[0].relation=""}},{key:"changeOrigin",value:function(e){"P"!==e.origin&&(e.param="")}},{key:"deleteRule",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleDelete({rule_id:t.id});case 3:if(a=e.sent,n=a.status,r=a.msg,this.loadingDone(),t.visible=!1,201===n){e.next=11;break}return this.$message({type:"error",message:r,showClose:!0}),e.abrupt("return");case 11:return e.next=13,this.getTable();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeStatusAll",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.changeVulStatus({mode:2,status:t});case 3:if(a=e.sent,this.loadingDone(),201===a.status){e.next=8;break}return this.$message({showClose:!0,message:a.msg,type:"error"}),e.abrupt("return");case 8:return this.$message({showClose:!0,message:a.msg,type:"success"}),this.currentPage=1,e.next=12,this.getBase();case 12:return e.next=14,this.getTable();case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeStatus",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.changeVulStatus({mode:1,ids:[t.id],status:t.status});case 3:if(a=e.sent,this.loadingDone(),201===a.status){e.next=8;break}return this.$message({showClose:!0,message:a.msg,type:"error"}),e.abrupt("return");case 8:return e.next=10,this.getBase();case 10:return e.next=12,this.getTable();case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteVuln",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.delVulStatus({id:t.id});case 3:if(a=e.sent,this.loadingDone(),201===a.status){e.next=8;break}return this.$message({showClose:!0,message:a.msg,type:"error"}),e.abrupt("return");case 8:return e.next=10,this.getBase();case 10:return e.next=12,this.getTable();case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"clearHookType",value:function(){this.hookType={type:this.ruleType,name:"",language_id:this.activeLanguage,short_name:"",enable:0},this.hookTypeDialog=!1}},{key:"enterHookType",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleTypeAdd(this.hookType);case 3:if(t=e.sent,a=t.status,n=t.msg,this.loadingDone(),201===a){e.next=10;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 10:return e.next=12,this.getTypes();case 12:this.clearHookType();case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"fmtType",value:function(e){switch(e){case"1":return this.$t("views.hookPage.spreadType");case"2":return this.$t("views.hookPage.contaminatedType");case"3":return this.$t("views.hookPage.filterType");case"4":return this.$t("views.hookPage.dangerType");case"5":return"主动验证"}}},{key:"clearHook",value:function(){this.hook={id:0,strategy_id:"",language_id:this.activeLanguage,value:"",status:1,type:"5"},this.hookDialog=!1}},{key:"fmtParams",value:function(e){var t="",a="";return e.forEach((function(e){"P"!==e.origin||t?"P"===e.origin&&t?t+=",".concat(e.param):a+="".concat(e.relation).concat(e.origin):t+="".concat(e.relation).concat(e.origin).concat(e.param)})),a+t}},{key:"enterHook",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.hook.id){e.next=16;break}return this.loadingStart(),e.next=4,this.services.setting.edit_vul_recheck_payload(Object(x["a"])({},this.hook));case 4:if(t=e.sent,a=t.status,n=t.msg,this.loadingDone(),201===a){e.next=11;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 11:return e.next=13,this.getTable();case 13:this.clearHook(),e.next=31;break;case 16:return this.loadingStart(),e.next=19,this.services.setting.vul_recheck_payload(Object(x["a"])({},this.hook));case 19:if(r=e.sent,s=r.status,o=r.msg,this.loadingDone(),201===s){e.next=26;break}return this.$message({type:"error",message:o,showClose:!0}),e.abrupt("return");case 26:return e.next=28,this.getBase();case 28:return e.next=30,this.getTable();case 30:this.clearHook();case 31:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"changeRuleType",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.currentPage=1,e.next=3,this.getTable();case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getTable",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.vulRecheckPayload({page:this.currentPage,page_size:this.pageSize,strategy_id:this.rule_type,language_id:this.activeLanguage,keyword:this.keyword});case 3:if(t=e.sent,a=t.status,n=t.msg,r=t.data,s=t.page,this.loadingDone(),201===a){e.next=12;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 12:if(this.total=s.alltotal,!(0===r.length&&this.currentPage>1)){e.next=18;break}return this.currentPage--,e.next=17,this.getTable();case 17:return e.abrupt("return");case 18:this.tableData=r;case 19:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(e){this.pageSize=e,this.currentPage=1,this.getTable()}},{key:"handleCurrentChange",value:function(e){this.currentPage=e,this.getTable()}},{key:"created",value:function(){this.hookType.type=this.ruleType,this.hook.type=this.ruleType,this.getTable(),this.getTypes()}}]),a}(g["a"]);Object(c["b"])([Object(h["c"])({default:"0",type:String})],T.prototype,"ruleType",void 0),Object(c["b"])([Object(h["c"])({default:1,type:Number})],T.prototype,"activeLanguage",void 0),Object(c["b"])([Object(h["c"])({default:"",type:String})],T.prototype,"activeLanguageName",void 0),Object(c["b"])([Object(h["c"])({default:function(){return!0},type:Function})],T.prototype,"getBase",void 0),T=Object(c["b"])([Object(h["a"])({name:"HookTable",filters:{formatTimestamp:function(e){return Object(d["a"])(e)}}})],T);var S=T,C=S,O=(a("9a7a"),Object(y["a"])(C,P,$,!1,null,"7133f3b0",null)),D=O.exports,j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-body"},[a("div",{staticClass:"flex-between"},[a("div",{style:{display:"flex",flex:1}},[a("el-select",{staticClass:"search-input",attrs:{size:"small",filterable:"",placeholder:e.$t("views.hookPage.selectType"),clearable:""},on:{change:function(t){return e.handleCurrentChange(1)}},model:{value:e.rule_type,callback:function(t){e.rule_type=t},expression:"rule_type"}},e._l(e.types,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),a("el-input",{staticClass:"search-input",staticStyle:{width:"260px"},attrs:{size:"small",placeholder:e.$t("views.hookPage.searchDesc")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleCurrentChange(1)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.handleCurrentChange(1)}},slot:"append"})],1)],1),a("div",[a("el-button",{staticClass:"resetAllBtn",style:{visibility:"3"===e.ruleType?"hidden":"visible"},attrs:{size:"small"},on:{click:function(t){e.hookTypeDialog=!0}}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "+e._s(e.$t("views.hookPage.addHookType")))]),a("el-button",{staticClass:"resetAllBtn",attrs:{size:"small"},on:{click:function(t){e.hookDialog=!0}}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "+e._s(e.$t("views.hookPage.addHook")))])],1)]),a("div",{staticClass:"btn-list-batch"},[a("span",{staticStyle:{color:"#38435a"}},[e._v(" "+e._s(e.$t("views.hookPage.selected"))+" "),a("span",{staticStyle:{color:"#4a72ae"}},[e._v(e._s(e.multipleSelection.length)+" ")]),e._v(e._s(e.$t("views.hookPage.strip"))+" ")]),a("div",[a("el-button",{staticClass:"resetAllBtn open",attrs:{size:"small"},on:{click:function(t){return e.changeStatusBatch("enable")}}},[e._v(e._s(e.multipleSelection.length?"":e.$t("views.hookPage.all"))+e._s(e.$t("views.hookPage.on")))]),a("el-button",{staticClass:"resetAllBtn stop",attrs:{size:"small"},on:{click:function(t){return e.changeStatusBatch("disable")}}},[e._v(e._s(e.multipleSelection.length?"":e.$t("views.hookPage.all"))+e._s(e.$t("views.hookPage.off")))]),a("el-button",{staticClass:"resetAllBtn delete",attrs:{size:"small"},on:{click:function(t){return e.changeStatusBatch("delete")}}},[e._v(e._s(e.multipleSelection.length?"":e.$t("views.hookPage.all"))+e._s(e.$t("views.hookPage.del")))])],1)]),a("el-table",{staticClass:"hookTable",attrs:{data:e.tableData,border:"","header-row-style":{color:"#000",fontWeight:600}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",fixed:!!e.tableData.length&&"left"}}),a("template",{slot:"empty"},[a("div",{staticClass:"empty-box"},[a("span",[e._v(e._s(e.$t("views.hookPage.empty")))])])]),a("el-table-column",{attrs:{align:"center",prop:"rule_type",label:e.$t("views.hookPage.hooksType"),width:"160",fixed:!!e.tableData.length&&"left"}}),a("el-table-column",{attrs:{align:"center",prop:"value",label:e.$t("views.hookPage.ruleInfo"),width:"340"}}),a("el-table-column",{attrs:{align:"center",prop:"source",label:e.$t("views.hookPage.point"),width:"en"===e.$i18n.locale?"120":"100"}}),a("el-table-column",{attrs:{prop:"target",label:e.$t("views.hookPage.pointOut"),width:"en"===e.$i18n.locale?"120":"100"}}),a("el-table-column",{attrs:{prop:"inherit",label:e.$t("views.hookPage.hoopDeep"),width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("true"===t.row.inherit?e.$t("views.hookPage.children"):"all"===t.row.inherit?e.$t("views.hookPage.nowChildren"):e.$t("views.hookPage.now"))+" ")]}}])}),a("el-table-column",{attrs:{prop:"update_time",label:e.$t("views.hookPage.updateTime"),sortable:"true",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatTimestamp")(t.row.update_time))+" ")]}}])}),e.rolesCheck(["system_admin","talent_admin"],!0)?a("el-table-column",{attrs:{prop:"user",label:e.$t("views.hookPage.user"),width:"180"}}):e._e(),a("el-table-column",{attrs:{align:"center","header-align":"center",label:e.$t("views.hookPage.status"),fixed:!!e.tableData.length&&"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#37D7BB","inactive-color":"#D9DDE1","active-value":1,"inactive-value":0},on:{change:function(a){return e.changeStatus(t.row)}},model:{value:t.row.enable,callback:function(a){e.$set(t.row,"enable",a)},expression:"scope.row.enable"}})]}}])}),a("el-table-column",{attrs:{prop:"address",label:e.$t("views.hookPage.address"),align:"center",width:"200",fixed:!!e.tableData.length&&"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-btn-box"},[a("el-button",{staticStyle:{color:"#4a72ae"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.editRow(t.row)}}},[e._v(" "+e._s(e.$t("views.hookPage.edit"))+" ")]),a("span",{staticClass:"l"},[e._v(" | ")]),a("el-popconfirm",{attrs:{title:e.$t("views.hookPage.delpop")},on:{confirm:function(a){return e.changeStatus(t.row,"delete")}}},[a("el-button",{staticStyle:{color:"#f56262"},attrs:{slot:"reference",size:"small",type:"text"},slot:"reference"},[e._v(e._s(e.$t("views.hookPage.del")))])],1)],1)]}}])})],2),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,background:"",layout:" prev, pager, next, jumper,total, sizes",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{visible:e.hookTypeDialog},on:{"update:visible":function(t){e.hookTypeDialog=t}}},[a("el-form",{attrs:{model:e.hookType,"label-width":"en"===e.$i18n.locale?"140px":"80px",size:"small"}},[a("el-form-item",{attrs:{label:e.$t("views.hookPage.hookType")}},[a("span",[e._v(e._s(e.fmtType(e.hookType.type)))])]),a("el-form-item",{attrs:{label:"语言"}},[a("span",[e._v(e._s(e.activeLanguageName))])]),a("el-form-item",{attrs:{label:e.$t("views.hookPage.typeName")}},[a("el-input",{attrs:{placeholder:e.$t("views.hookPage.namePlaceholder")},model:{value:e.hookType.name,callback:function(t){e.$set(e.hookType,"name",t)},expression:"hookType.name"}})],1),a("el-form-item",{attrs:{label:e.$t("views.hookPage.typeShotName")}},[a("el-input",{attrs:{placeholder:e.$t("views.hookPage.shotNamePlaceholder")},model:{value:e.hookType.short_name,callback:function(t){e.$set(e.hookType,"short_name",t)},expression:"hookType.short_name"}})],1),a("el-form-item",{attrs:{label:e.$t("views.hookPage.openOrNot")}},[a("el-switch",{attrs:{"active-color":"#37D7BB","inactive-color":"#D9DDE1","active-value":1,"inactive-value":0},model:{value:e.hookType.enable,callback:function(t){e.$set(e.hookType,"enable",t)},expression:"hookType.enable"}})],1)],1),a("template",{slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.clearHookType}},[e._v(e._s(e.$t("views.hookPage.clear")))]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.enterHookType}},[e._v(e._s(e.$t("views.hookPage.enter")))])],1)],2),a("el-dialog",{attrs:{visible:e.hookDialog},on:{"update:visible":function(t){e.hookDialog=t}}},[a("el-form",{attrs:{model:e.hook,size:"small","label-width":"en"===e.$i18n.locale?"140px":"80px"}},[a("el-form-item",{attrs:{label:e.$t("views.hookPage.hookType")}},[a("span",[e._v(e._s(e.fmtType(e.hook.type)))])]),a("el-form-item",{attrs:{label:e.$t("views.hookPage.hooksType")}},[a("el-select",{attrs:{placeholder:e.$t("views.hookPage.namePlaceholder")},model:{value:e.hook.rule_type_id,callback:function(t){e.$set(e.hook,"rule_type_id",t)},expression:"hook.rule_type_id"}},e._l(e.types,(function(e){return a("el-option",{key:e.id,staticStyle:{width:"100%"},attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:e.$t("views.hookPage.ruleInfo")}},[a("el-input",{attrs:{placeholder:e.$t("views.hookPage.ruleInfoPlaceholder")},model:{value:e.hook.rule_value,callback:function(t){e.$set(e.hook,"rule_value",t)},expression:"hook.rule_value"}})],1),e._l(e.hook.source,(function(t,n){return[a("el-form-item",{key:"source-"+n,attrs:{label:0===n?e.$t("views.hookPage.source"):" "}},[n>0?a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:e.$t("views.hookPage.relation")},model:{value:t.relation,callback:function(a){e.$set(t,"relation",a)},expression:"item.relation"}},e._l(e.relations,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:e.$t("views.hookPage.origin")},on:{change:function(a){return e.changeOrigin(t)}},model:{value:t.origin,callback:function(a){e.$set(t,"origin",a)},expression:"item.origin"}},e._l(e.origins,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:"O"===t.value&&e.hook.source.some((function(e){return"O"===e.origin}))||"R"===t.value&&e.hook.source.some((function(e){return"R"===e.origin}))}})})),1),"P"===t.origin?a("el-input",{staticStyle:{width:"18%","margin-left":"10px"},attrs:{placeholder:e.$t("views.hookPage.paramPlaceholder")},model:{value:t.param,callback:function(a){e.$set(t,"param",a)},expression:"item.param"}}):e._e(),a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.addSource(e.hook.source)}}},[e._v(e._s(e.$t("views.hookPage.add")))]),e.hook.source.length>1?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteSource(e.hook.source,n)}}},[e._v(e._s(e.$t("views.hookPage.del")))]):e._e()],1)],1)]})),e._l(e.hook.target,(function(t,n){return[a("el-form-item",{key:"target"+n,attrs:{label:0===n?e.$t("views.hookPage.target"):""}},[n>0?a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:e.$t("views.hookPage.relation")},model:{value:t.relation,callback:function(a){e.$set(t,"relation",a)},expression:"item.relation"}},e._l(e.relations,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),a("el-select",{staticStyle:{width:"18%"},attrs:{placeholder:e.$t("views.hookPage.origin")},on:{change:function(a){return e.changeOrigin(t)}},model:{value:t.origin,callback:function(a){e.$set(t,"origin",a)},expression:"item.origin"}},e._l(e.origins,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:"O"===t.value&&e.hook.target.some((function(e){return"O"===e.origin}))||"R"===t.value&&e.hook.target.some((function(e){return"R"===e.origin}))}})})),1),"P"===t.origin?a("el-input",{staticStyle:{width:"18%","margin-left":"10px"},attrs:{placeholder:e.$t("views.hookPage.paramPlaceholder")},model:{value:t.param,callback:function(a){e.$set(t,"param",a)},expression:"item.param"}}):e._e(),a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.addSource(e.hook.target)}}},[e._v(e._s(e.$t("views.hookPage.add")))]),e.hook.target.length>1?a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.deleteSource(e.hook.target,n)}}},[e._v(e._s(e.$t("views.hookPage.del")))]):e._e()],1)],1)]})),a("el-form-item",{attrs:{label:e.$t("views.hookPage.hookTrack")}},[a("el-radio",{attrs:{selected:"",label:"false"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v(e._s(e.$t("views.hookPage.onlyNow")))]),a("el-radio",{attrs:{label:"true"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v(e._s(e.$t("views.hookPage.onlyChildren")))]),a("el-radio",{attrs:{label:"all"},model:{value:e.hook.inherit,callback:function(t){e.$set(e.hook,"inherit",t)},expression:"hook.inherit"}},[e._v(e._s(e.$t("views.hookPage.nowChildren")))])],1)],2),a("template",{slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.clearHook}},[e._v(e._s(e.$t("views.hookPage.clear")))]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.enterHook}},[e._v(e._s(e.$t("views.hookPage.enter")))])],1)],2)],1)},R=[],z=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.keyword="",e.rule_type="",e.hookTypeDialog=!1,e.hookDialog=!1,e.hookType={type:"1",name:"",short_name:"",enable:1,language_id:e.activeLanguage},e.types=[],e.multipleSelection=[],e.hook={id:0,type:"1",rule_type_id:"",rule_value:"",source:[{relation:"",origin:"",param:""}],target:[{relation:"",origin:"",param:""}],inherit:"false"},e.relations=[{label:e.$t("views.hookPage.or"),value:"|"},{label:e.$t("views.hookPage.and"),value:"&"}],e.origins=[{label:e.$t("views.hookPage.O"),value:"O"},{label:e.$t("views.hookPage.R"),value:"R"},{label:e.$t("views.hookPage.P"),value:"P"}],e.tableData=[],e.pageSize=20,e.currentPage=1,e.total=0,e}return Object(i["a"])(a,[{key:"handleSelectionChange",value:function(e){this.multipleSelection=e}},{key:"splitAndIn",value:function(e,t){for(var a=e.split(t),n=0;n<a.length;n++)n%2!=0&&(a.splice(n,0,t),n++);return a}},{key:"makeParamsArr",value:function(e){function t(e,t){var a=[];if("P"===e[0]){var n=e.substring(1,e.length),r=n.split(",");r.forEach((function(e){a.some((function(e){return"P"===e.origin}))?a.push({relation:"&",origin:"P",param:e}):a.push({relation:t,origin:"P",param:e})}))}else a.push({relation:t,origin:e,param:""});return a}function a(e){var a=[];return 1==e.length?a.push.apply(a,Object(k["a"])(t(e[0],""))):a.push.apply(a,Object(k["a"])(t(e[1],e[0]))),a}for(var n=[],r=[],s=0,o=0;o<e.length;o++)"|"!=e[o]&&"&"!=e[o]||(n.push(e.slice(s,o)),s=o),o==e.length-1&&n.push(e.slice(s,e.length));for(var i=0;i<n.length;i++)r.push.apply(r,Object(k["a"])(a(n[i])));return r}},{key:"editRow",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,s,o,i,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a=this.splitAndIn(t.source,"|"),n=0;n<a.length;n++)a[n].indexOf("&")>-1&&(r=this.splitAndIn(a[n],"&"),a.splice.apply(a,[n,1].concat(Object(k["a"])(r))),n+=r.length);for(s=this.makeParamsArr(a),o=this.splitAndIn(t.target,"|"),i=0;i<o.length;i++)o[i].indexOf("&")>-1&&(l=this.splitAndIn(o[i],"&"),a.splice.apply(a,[i,1].concat(Object(k["a"])(l))),i+=l.length);u=this.makeParamsArr(o),this.hook.rule_value=t.value,this.hook.id=t.id,this.hook.inherit=t.inherit,this.hook.source=s,this.hook.target=u,this.hook.rule_type_id=t.rule_type_id,this.hookDialog=!0;case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTypes",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleTypes({type:this.ruleType,language_id:this.activeLanguage});case 3:if(t=e.sent,a=t.status,n=t.msg,r=t.data,this.loadingDone(),201===a){e.next=11;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 11:this.types=r;case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"deleteRule",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleDelete({rule_id:t.id});case 3:if(a=e.sent,n=a.status,r=a.msg,this.loadingDone(),t.visible=!1,201===n){e.next=11;break}return this.$message({type:"error",message:r,showClose:!0}),e.abrupt("return");case 11:return e.next=13,this.getTable();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"addSource",value:function(e){e.push({relation:"",origin:"",param:""})}},{key:"deleteSource",value:function(e,t){e.splice(t,1),e[0].relation=""}},{key:"changeOrigin",value:function(e){"P"!==e.origin&&(e.param="")}},{key:"changeStatusBatch",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a="",e.t0=t,e.next="delete"===e.t0?4:"enable"===e.t0?6:"disable"===e.t0?8:10;break;case 4:return a=this.$t("views.hookPage.del"),e.abrupt("break",10);case 6:return a=this.$t("views.hookPage.on"),e.abrupt("break",10);case 8:return a=this.$t("views.hookPage.off"),e.abrupt("break",10);case 10:this.$confirm("".concat(this.$t("views.hookPage.changeOne")).concat(a).concat(this.$t("views.hookPage.changeTwo")),this.$t("views.hookPage.pop"),{confirmButtonText:this.$t("views.hookPage.enter"),cancelButtonText:this.$t("views.hookPage.clear"),type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function e(){var a,r,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==n.multipleSelection.length){e.next=3;break}return n.changeStatusAll(t),e.abrupt("return");case 3:return a=n.multipleSelection.map((function(e){return e.id})),e.next=6,n.services.setting.changeStatusBatch({ids:String(a),op:t});case 6:if(r=e.sent,s=r.status,o=r.msg,201===s){e.next=12;break}return n.$message({type:"error",message:o,showClose:!0}),e.abrupt("return");case 12:return n.$message({type:"success",message:o,showClose:!0}),e.next=15,n.getBase();case 15:return e.next=17,n.getTable();case 17:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e)}));case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeStatusAll",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.changeStatus({scope:"all",op:t,language_id:this.activeLanguage,hook_rule_type:this.ruleType});case 3:if(a=e.sent,this.loadingDone(),201===a.status){e.next=8;break}return this.$message({showClose:!0,message:a.msg,type:"error"}),e.abrupt("return");case 8:return this.$message({showClose:!0,message:a.msg,type:"success"}),this.currentPage=1,e.next=12,this.getBase();case 12:return e.next=14,this.getTable();case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeStatus",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,n,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:"",this.loadingStart(),e.next=4,this.services.setting.changeStatus({rule_id:t.id,op:a||(0===t.enable?"disable":"enable")});case 4:if(n=e.sent,this.loadingDone(),201===n.status){e.next=9;break}return this.$message({showClose:!0,message:n.msg,type:"error"}),e.abrupt("return");case 9:return e.next=11,this.getBase();case 11:return e.next=13,this.getTable();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"clearHookType",value:function(){this.hookType={type:this.ruleType,name:"",language_id:this.activeLanguage,short_name:"",enable:1},this.hookTypeDialog=!1}},{key:"enterHookType",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.ruleTypeAdd(this.hookType);case 3:if(t=e.sent,a=t.status,n=t.msg,this.loadingDone(),201===a){e.next=10;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 10:return e.next=12,this.getTypes();case 12:this.clearHookType();case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"fmtType",value:function(e){switch(e){case"1":return this.$t("views.hookPage.spreadType");case"2":return this.$t("views.hookPage.contaminatedType");case"3":return this.$t("views.hookPage.filterType");case"4":return this.$t("views.hookPage.dangerType");case"5":return this.$t("views.hookPage.enterType")}}},{key:"clearHook",value:function(){this.hook={id:0,type:this.ruleType,rule_type_id:"",rule_value:"",source:[{relation:"",origin:"",param:""}],target:[{relation:"",origin:"",param:""}],inherit:"false"},this.hookDialog=!1}},{key:"fmtParams",value:function(e){var t="",a="";return e.forEach((function(e){"P"!==e.origin||t?"P"===e.origin&&t?t+=",".concat(e.param):a+="".concat(e.relation).concat(e.origin):t+="".concat(e.relation).concat(e.origin).concat(e.param)})),a+t}},{key:"enterHook",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,s,o,i,l,u,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.hook.id){e.next=18;break}return this.loadingStart(),t=this.fmtParams(this.hook.source),a=this.fmtParams(this.hook.target),e.next=6,this.services.setting.modifyAdd({rule_id:this.hook.id,rule_type_id:this.hook.rule_type_id,rule_value:this.hook.rule_value,rule_target:a,rule_source:t,inherit:this.hook.inherit,track:"false"});case 6:if(n=e.sent,r=n.status,s=n.msg,this.loadingDone(),201===r){e.next=13;break}return this.$message({type:"error",message:s,showClose:!0}),e.abrupt("return");case 13:return e.next=15,this.getTable();case 15:this.clearHook(),e.next=35;break;case 18:return this.loadingStart(),o=this.fmtParams(this.hook.source),i=this.fmtParams(this.hook.target),e.next=23,this.services.setting.ruleAdd({rule_type_id:this.hook.rule_type_id,rule_value:this.hook.rule_value,rule_target:i,rule_source:o,inherit:this.hook.inherit,track:"false"});case 23:if(l=e.sent,u=l.status,c=l.msg,this.loadingDone(),201===u){e.next=30;break}return this.$message({type:"error",message:c,showClose:!0}),e.abrupt("return");case 30:return e.next=32,this.getBase();case 32:return e.next=34,this.getTable();case 34:this.clearHook();case 35:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getTable",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.hookRuleList({page:this.currentPage,pageSize:this.pageSize,type:this.ruleType,strategy_type:this.rule_type,language_id:this.activeLanguage,keyword:this.keyword});case 3:if(t=e.sent,a=t.status,n=t.msg,r=t.data,s=t.page,this.loadingDone(),201===a){e.next=12;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 12:if(this.total=s.alltotal,!(0===r.length&&this.currentPage>1)){e.next=18;break}return this.currentPage--,e.next=17,this.getTable();case 17:return e.abrupt("return");case 18:this.tableData=r;case 19:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(e){this.pageSize=e,this.currentPage=1,this.getTable()}},{key:"handleCurrentChange",value:function(e){this.currentPage=e,this.getTable()}},{key:"created",value:function(){this.hookType.type=this.ruleType,this.hook.type=this.ruleType,this.getTable(),this.getTypes()}}]),a}(g["a"]);Object(c["b"])([Object(h["c"])({default:"0",type:String})],z.prototype,"ruleType",void 0),Object(c["b"])([Object(h["c"])({default:1,type:Number})],z.prototype,"activeLanguage",void 0),Object(c["b"])([Object(h["c"])({default:"",type:String})],z.prototype,"activeLanguageName",void 0),Object(c["b"])([Object(h["c"])({default:function(){return!0},type:Function})],z.prototype,"getBase",void 0),z=Object(c["b"])([Object(h["a"])({name:"HookTable",filters:{formatTimestamp:function(e){return Object(d["a"])(e)}}})],z);var B=z,L=B,H=(a("1f58"),Object(y["a"])(L,j,R,!1,null,"3abcb5c8",null)),A=H.exports,N=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.activeLanguage=0,e.activeLanguageName="",e.languageOptions=[],e.reflash=!1,e.type="2",e.base={ruleCount:0,typeCount:0,sinkCount:0},e}return Object(i["a"])(a,[{key:"changeLanguage",value:function(e){var t=this;this.activeLanguage=e.id,this.activeLanguageName=e.name,this.reflash=!1,this.$nextTick((function(){t.getBase(),t.reflash=!0}))}},{key:"getBase",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.hookRuleSummary({language_id:this.activeLanguage});case 3:if(t=e.sent,a=t.status,n=t.msg,r=t.data,this.loadingDone(),201===a){e.next=11;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 11:this.base=r;case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getProgramLanguage",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,r,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.setting.programLanguage();case 3:if(t=e.sent,a=t.status,n=t.msg,r=t.data,this.loadingDone(),201===a){e.next=11;break}return this.$message({type:"error",message:n,showClose:!0}),e.abrupt("return");case 11:this.languageOptions=r,this.activeLanguage=r[0].id,this.activeLanguageName=r[0].name,this.type="2",this.$nextTick((function(){s.getBase(),s.reflash=!0}));case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){this.getProgramLanguage()}}]),a}(g["a"]);N=Object(c["b"])([Object(h["a"])({name:"HookRule",components:{DangerTable:_,HookTable:A,VulnTable:D}})],N);var E=N,I=E,V=(a("cab4"),a("82c0"),Object(y["a"])(I,n,r,!1,null,"33435546",null));t["default"]=V.exports},"9a7a":function(e,t,a){"use strict";a("743c")},cab4:function(e,t,a){"use strict";a("55fe")}}]);
//# sourceMappingURL=chunk-6d6d7504.c5d2e91d.js.map