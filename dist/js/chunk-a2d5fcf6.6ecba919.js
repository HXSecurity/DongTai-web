(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a2d5fcf6"],{1276:function(e,t,s){"use strict";var a=s("2ba4"),i=s("c65b"),n=s("e330"),l=s("d784"),r=s("44e7"),c=s("825a"),o=s("1d80"),u=s("4840"),v=s("8aa5"),d=s("50c4"),f=s("577e"),p=s("dc4a"),h=s("4dae"),b=s("14c3"),_=s("9263"),g=s("9f7f"),m=s("d039"),w=g.UNSUPPORTED_Y,D=4294967295,y=Math.min,C=[].push,V=n(/./.exec),k=n(C),x=n("".slice),O=!m((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var s="ab".split(e);return 2!==s.length||"a"!==s[0]||"b"!==s[1]}));l("split",(function(e,t,s){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,s){var n=f(o(this)),l=void 0===s?D:s>>>0;if(0===l)return[];if(void 0===e)return[n];if(!r(e))return i(t,n,e,l);var c,u,v,d=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),b=0,g=new RegExp(e.source,p+"g");while(c=i(_,g,n)){if(u=g.lastIndex,u>b&&(k(d,x(n,b,c.index)),c.length>1&&c.index<n.length&&a(C,d,h(c,1)),v=c[0].length,b=u,d.length>=l))break;g.lastIndex===c.index&&g.lastIndex++}return b===n.length?!v&&V(g,"")||k(d,""):k(d,x(n,b)),d.length>l?h(d,0,l):d}:"0".split(void 0,0).length?function(e,s){return void 0===e&&0===s?[]:i(t,this,e,s)}:t,[function(t,s){var a=o(this),l=void 0==t?void 0:p(t,e);return l?i(l,t,a,s):i(n,f(a),t,s)},function(e,a){var i=c(this),l=f(e),r=s(n,i,l,a,n!==t);if(r.done)return r.value;var o=u(i,RegExp),p=i.unicode,h=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(w?"g":"y"),_=new o(w?"^(?:"+i.source+")":i,h),g=void 0===a?D:a>>>0;if(0===g)return[];if(0===l.length)return null===b(_,l)?[l]:[];var m=0,C=0,V=[];while(C<l.length){_.lastIndex=w?0:C;var O,j=b(_,w?x(l,C):l);if(null===j||(O=y(d(_.lastIndex+(w?C:0)),l.length))===m)C=v(l,C,p);else{if(k(V,x(l,m,C)),V.length===g)return V;for(var $=1;$<=j.length-1;$++)if(k(V,j[$]),V.length===g)return V;C=m=O}}return k(V,x(l,m)),V}]}),!O,w)},"12ca":function(e,t,s){},"2c8d":function(e,t,s){"use strict";s("e7bc")},"359d":function(e,t,s){"use strict";s("12ca")},4612:function(e,t,s){},"57fe":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",{staticClass:"container"},[s("div",{staticClass:"vuln-warp",class:e.sliderWarpContract?"slider-warp-contract":"slider-warp-spreadOut"},[s("div",{staticClass:"go-back-title"},[s("span",{on:{click:e.goBack}},[s("i",{staticClass:"el-icon-arrow-left"}),e._v(" 返回列表 ")])]),s("div",{staticClass:"vuln-title flex-row-space-between"},[s("div",{staticStyle:{flex:"1","max-width":"800px","word-break":"break-all","line-height":"32px"}},[e._v(" "+e._s(e.assetVulDetail.base_info&&e.assetVulDetail.base_info.vul_title)+" ")]),s("div",{staticClass:"btnWarp"},[s("Sync",{attrs:{item:e.syncInfo,"setting-inte":e.settingInte,"get-table-data":e.init,source_type:2}})],1)]),e.assetVulDetail.base_info?[s("div",{staticClass:"module-title has-log"},[s("span",[e._v("基本信息")]),s("span",{staticClass:"get-log",on:{click:e.vullogBtn}},[e._v("查看日志")])]),s("div",{staticClass:"infoWarp"},[s("div",{staticClass:"infoLine flex-row-space-between"},[s("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[s("span",{staticClass:"label"},[e._v(" 危害级别： ")]),s("span",{staticClass:"dot",style:{color:e.levelColor(e.assetVulDetail.base_info.level)}},[e._v(e._s(e.assetVulDetail.base_info.level))])]),s("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[s("span",{staticClass:"label"},[e._v(" 首次出现： ")]),s("span",[e._v(e._s(e.fmtTime(e.assetVulDetail.base_info.first_time)))])]),s("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[s("span",{staticClass:"label"},[e._v(" 最新活跃： ")]),s("span",[s("span",[e._v(e._s(e.fmtTime(e.assetVulDetail.base_info.last_time)))])])])]),s("div",{staticClass:"infoLine flex-row-space-between"},[s("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[s("span",{staticClass:"label"},[e._v(" 漏洞类型： ")]),s("span",[e._v(e._s(e.assetVulDetail.base_info&&e.assetVulDetail.base_info.vul_type))])]),s("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[s("span",{staticClass:"label"},[e._v(" 编号： ")]),e._l(e.CVENUMBERS,(function(t,a){return s("span",{key:"cve"+a},[t.label?s("span",{staticClass:"jump",on:{click:function(s){return e.openWindow(t.link)}}},[e._v(e._s(t.label)+" ")]):e._e(),e._v(e._s(a!=e.CVENUMBERS.length-1&&t.label?"|":"")+" ")])}))],2),s("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[s("span",{staticClass:"label"},[e._v(" 可利用性： ")]),s("span",[e._v(e._s(1===e.assetVulDetail.base_info.have_article?"存在分析文章":"")+" "+e._s(1===e.assetVulDetail.base_info.have_poc?"存在可利用代码":"")+" "+e._s(1!==e.assetVulDetail.base_info.have_poc&&1!==e.assetVulDetail.base_info.have_article?"不存在可利用代码":"")+" ")])])]),s("div",{staticClass:"infoLine flex-row-space-between"},[s("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[s("span",{staticClass:"label"},[e._v(" 项目名称： ")]),s("el-tooltip",{attrs:{effect:"light",content:e.assetVulDetail.base_info.project_names&&e.assetVulDetail.base_info.project_names.join(" | "),placement:"top"}},[s("span",[e._v(e._s(e.assetVulDetail.base_info.project_names&&e.assetVulDetail.base_info.project_names.join(" | ")))])])],1),s("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[s("span",{staticClass:"label"},[e._v(" 语言： ")]),s("span",{staticClass:"dot"},[e._v(e._s(e.assetVulDetail.base_info.language))])])])]),s("div",{staticClass:"module-title"},[e._v("漏洞描述")]),s("div",{staticClass:"vulnDesc"},[e._v(" "+e._s(e.assetVulDetail.base_info&&e.assetVulDetail.base_info.vul_detail)+" ")]),e._l(e.assetVulDetail.poc_info&&e.assetVulDetail.poc_info.poc_list,(function(t,a){return s("div",{key:a},[s("div",{staticClass:"module-title"},[e._v(e._s(t.title))]),s("div",{staticClass:"markdownContent httpRequest"},[s("MyMarkdownIt",{staticStyle:{color:"#747c8c"},attrs:{content:t.poc_content}})],1)])})),s("div",{staticClass:"module-title"},[e._v("参考及分析文章")]),s("div",{staticClass:"vulnDesc"},e._l(e.assetVulDetail.poc_info&&e.assetVulDetail.poc_info.reference_link,(function(t){return s("div",{key:t.url,staticClass:"vulnUrl",on:{click:function(s){return e.openUrl(t.url)}}},[e._v(" "+e._s(t.url)+" ")])})),0)]:e._e()],2),s("el-dialog",{attrs:{visible:e.deleteDialogOpen,title:e.$t("views.vulnDetail.deleteVuln"),width:"25%"},on:{"update:visible":function(t){e.deleteDialogOpen=t}}},[s("div",{staticStyle:{"text-align":"center"}},[s("p",{staticStyle:{color:"#959fb4"}},[e._v(" "+e._s(e.$t("views.vulnDetail.deleteVulnInfo"))+" ")]),s("p",{staticStyle:{color:"#959fb4","margin-top":"14px"}},[e._v(" "+e._s(e.$t("views.vulnDetail.deleteVulnDesc"))+" ")])]),s("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticClass:"confirmDel",attrs:{type:"text"},on:{click:e.vulnDelete}},[e._v(" "+e._s(e.$t("views.vulnDetail.deleteVulnEnter"))+" ")]),s("el-button",{staticClass:"cancelDel",attrs:{type:"text"},on:{click:function(t){e.deleteDialogOpen=!1}}},[e._v(" "+e._s(e.$t("views.vulnDetail.cancel"))+" ")])],1)]),s("el-dialog",{attrs:{visible:e.logDialogOpen,title:"查看日志",width:"700px","custom-class":"sca-dialog"},on:{"update:visible":function(t){e.logDialogOpen=t}}},[s("div",{staticClass:"log-list"},e._l(e.logList,(function(t){return s("div",{key:t.id,staticClass:"log-item"},[s("div",{staticClass:"log-item-name"},[e._v(e._s(t.msg))]),s("div",{staticClass:"log-item-time"},[e._v(e._s(e.fmtTime(t.datetime)))])])})),0)])],1)},i=[],n=s("1da1"),l=s("d4ec"),r=s("bee2"),c=s("262e"),o=s("2caf"),u=(s("ac1f"),s("1276"),s("d3b7"),s("25f0"),s("96cf"),s("9ab4")),v=s("60a3"),d=s("73ec"),f=s("8c73"),p=s("f36b"),h=function(e){Object(c["a"])(s,e);var t=Object(o["a"])(s);function s(){var e;return Object(l["a"])(this,s),e=t.apply(this,arguments),e.sliderWarpContract=!1,e.deleteDialogOpen=!1,e.logDialogOpen=!1,e.settingInte=[],e.assetVulDetail={},e.goBack=function(){e.$router.push({name:"vulnList"})},e.statusOptions=[{value:e.$t("views.vulnDetail.reported"),label:e.$t("views.vulnDetail.reported")},{value:e.$t("views.vulnDetail.confirmed"),label:e.$t("views.vulnDetail.confirmed")},{value:e.$t("views.vulnDetail.fixed"),label:e.$t("views.vulnDetail.fixed")},{value:e.$t("views.vulnDetail.ignored"),label:e.$t("views.vulnDetail.ignored")}],e.tableData=[],e.page=1,e.keyword="",e.selectedId=0,e.total=0,e.orderOptions=[{label:e.$t("views.vulnList.orderOptions.type"),value:"type"},{label:e.$t("views.vulnList.orderOptions.level"),value:"level"},{label:e.$t("views.vulnList.orderOptions.url"),value:"url"},{label:e.$t("views.vulnList.orderOptions.latest_time"),value:"latest_time"},{label:e.$t("views.vulnList.orderOptions.first_time"),value:"first_time"}],e.syncInfo={},e.aggr_id=0,e.logList=[],e}return Object(r["a"])(s,[{key:"fmtTime",value:function(e){if(e){var t=new Date(e).getTime()/1e3;return Object(d["a"])(t)}return""}},{key:"openUrl",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:window.open(t);case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"CVENUMBERS",get:function(){var e=[];for(var t in this.assetVulDetail.base_info)switch(t){case"cnnvd":e.push({label:this.assetVulDetail.base_info[t],link:"http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=".concat(this.assetVulDetail.base_info[t])});break;case"cnvd":e.push({label:this.assetVulDetail.base_info[t],link:"https://www.cnvd.org.cn/flaw/show/".concat(this.assetVulDetail.base_info[t])});break;case"cve":e.push({label:this.assetVulDetail.base_info[t],link:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=".concat(this.assetVulDetail.base_info[t])});break;case"cwe":var s=this.assetVulDetail.base_info[t]&&this.assetVulDetail.base_info[t].split("-")[1];e.push({label:this.assetVulDetail.base_info[t],link:"https://cwe.mitre.org/data/definitions/".concat(s,".html")});break}return e}},{key:"openWindow",value:function(e){window.open(e)}},{key:"levelColor",value:function(e){switch(e){case"严重":return"#E56363";case"高危":return"#F49E0B";case"中危":return"#2F90EA";case"低危":return"#ABB2C0";case"提示":return"#DBDBDB"}}},{key:"init",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.aggr_id=parseInt(this.$route.params.page),this.selectedId=parseInt(this.$route.params.id),e.next=4,this.getAssetVulDetail();case 4:this.syncInfo={source_type:2,id:this.aggr_id,create_time:this.assetVulDetail.base_info.first_time,type_name:this.assetVulDetail.base_info.vul_type,package_language:this.assetVulDetail.base_info.language,vul_number:(this.assetVulDetail.base_info.cnnvd?this.assetVulDetail.base_info.cnnvd+" | ":"")+(this.assetVulDetail.base_info.cnvd?this.assetVulDetail.base_info.cnvd+" | ":"")+(this.assetVulDetail.base_info.cve?this.assetVulDetail.base_info.cve+" | ":"")+(this.assetVulDetail.base_info.cwe?this.assetVulDetail.base_info.cwe+" | ":""),level_id:this.assetVulDetail.base_info.level,vul_name:this.assetVulDetail.base_info.vul_title,pro_info:this.assetVulDetail.base_info.project_names};case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getAssetVulDetail",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.services.sca.assetVulDetail({aggr_id:this.aggr_id,vul_package_id:this.selectedId});case 2:if(t=e.sent,201===t.status){e.next=6;break}return this.$message.error(t.msg),e.abrupt("return");case 6:this.assetVulDetail=t.data;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.init();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"vulnDelete",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.vuln.vulnDelete(this.selectedId);case 3:t=e.sent,s=t.status,a=t.msg,this.loadingDone(),201!==s?this.$message({type:"error",message:a,showClose:!0}):(this.$message({type:"success",message:a,showClose:!0}),this.$router.push("/vuln/vulnList"));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"vullogBtn",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.services.vuln.vullog(this.$route.query.id,"2");case 2:t=e.sent,this.logList=t.status,this.logDialogOpen=!0;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"recheckVul",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={ids:this.selectedId.toString()},e.next=3,this.services.vuln.vulRecheck(t);case 3:s=e.sent,a=s.status,i=s.msg,201!==a?this.$message({type:"error",message:i,showClose:!0}):this.$message({type:"success",message:i,showClose:!0});case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),s}(f["a"]);h=Object(u["b"])([Object(v["a"])({name:"VulnDetail",components:{Sync:p["a"]}})],h);var b=h,_=b,g=(s("359d"),s("6bc4"),s("2c8d"),s("2877")),m=Object(g["a"])(_,a,i,!1,null,"ddf8ef9c",null);t["default"]=m.exports},"6bc4":function(e,t,s){"use strict";s("4612")},"91a0":function(e,t,s){},"9ab6":function(e,t,s){"use strict";s("91a0")},e7bc:function(e,t,s){},f36b:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"sync"},[s("div",{staticClass:"integration"},[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[s("div",{staticClass:"checkedAllBtn",on:{click:e.deleteVuln}},[s("i",{staticClass:"icon iconfont"},[e._v("")])])])],1)])},i=[],n=s("1da1"),l=s("d4ec"),r=s("bee2"),c=s("262e"),o=s("2caf"),u=(s("96cf"),s("9ab4")),v=s("60a3"),d=s("8c73"),f=function(e){Object(c["a"])(s,e);var t=Object(o["a"])(s);function s(){return Object(l["a"])(this,s),t.apply(this,arguments)}return Object(r["a"])(s,[{key:"toPathName",value:function(e){this.$router.push({name:e})}},{key:"deleteVuln",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$confirm("该操作将会删除选中漏洞",this.$t("views.vulnList.recheckInfo"),{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.services.vuln.vulListDelete({source_type:t.source_type,ids:String(t.item.id)});case 2:s=e.sent,201!==s.status?t.$message({type:"error",message:s.msg,showClose:!0}):t.$message({type:"success",message:s.msg,showClose:!0}),t.getTableData(!0);case 5:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),s}(d["a"]);Object(u["b"])([Object(v["c"])()],f.prototype,"item",void 0),Object(u["b"])([Object(v["c"])()],f.prototype,"getTableData",void 0),Object(u["b"])([Object(v["c"])()],f.prototype,"source_type",void 0),f=Object(u["b"])([Object(v["a"])({name:"VulnList"})],f);var p=f,h=p,b=(s("9ab6"),s("2877")),_=Object(b["a"])(h,a,i,!1,null,"423df9e2",null);t["a"]=_.exports}}]);
//# sourceMappingURL=chunk-a2d5fcf6.6ecba919.js.map