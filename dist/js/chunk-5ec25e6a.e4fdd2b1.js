(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ec25e6a"],{1276:function(e,t,a){"use strict";var i=a("2ba4"),s=a("c65b"),n=a("e330"),l=a("d784"),r=a("44e7"),o=a("825a"),c=a("1d80"),u=a("4840"),v=a("8aa5"),p=a("50c4"),d=a("577e"),f=a("dc4a"),h=a("4dae"),m=a("14c3"),g=a("9263"),b=a("9f7f"),y=a("d039"),_=b.UNSUPPORTED_Y,w=4294967295,C=Math.min,j=[].push,O=n(/./.exec),x=n(j),D=n("".slice),$=!y((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var a="ab".split(e);return 2!==a.length||"a"!==a[0]||"b"!==a[1]}));l("split",(function(e,t,a){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,a){var n=d(c(this)),l=void 0===a?w:a>>>0;if(0===l)return[];if(void 0===e)return[n];if(!r(e))return s(t,n,e,l);var o,u,v,p=[],f=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,b=new RegExp(e.source,f+"g");while(o=s(g,b,n)){if(u=b.lastIndex,u>m&&(x(p,D(n,m,o.index)),o.length>1&&o.index<n.length&&i(j,p,h(o,1)),v=o[0].length,m=u,p.length>=l))break;b.lastIndex===o.index&&b.lastIndex++}return m===n.length?!v&&O(b,"")||x(p,""):x(p,D(n,m)),p.length>l?h(p,0,l):p}:"0".split(void 0,0).length?function(e,a){return void 0===e&&0===a?[]:s(t,this,e,a)}:t,[function(t,a){var i=c(this),l=void 0==t?void 0:f(t,e);return l?s(l,t,i,a):s(n,d(i),t,a)},function(e,i){var s=o(this),l=d(e),r=a(n,s,l,i,n!==t);if(r.done)return r.value;var c=u(s,RegExp),f=s.unicode,h=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(_?"g":"y"),g=new c(_?"^(?:"+s.source+")":s,h),b=void 0===i?w:i>>>0;if(0===b)return[];if(0===l.length)return null===m(g,l)?[l]:[];var y=0,j=0,O=[];while(j<l.length){g.lastIndex=_?0:j;var $,k=m(g,_?D(l,j):l);if(null===k||($=C(p(g.lastIndex+(_?j:0)),l.length))===y)j=v(l,j,f);else{if(x(O,D(l,y,j)),O.length===b)return O;for(var S=1;S<=k.length-1;S++)if(x(O,k[S]),O.length===b)return O;j=y=$}}return x(O,D(l,y)),O}]}),!$,_)},"2b88":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("main",{staticClass:"container"},[e.sliderWarpContract?e._e():a("div",{staticClass:"fixed-warp"},[a("div",{staticClass:"slider-warp"},[a("div",{staticClass:"titleForm"},[e._v(" "+e._s(e.$t("views.vulnDetail.vulnList"))+" ")]),a("div",{staticClass:"page-line flex-column-center"},[a("div",{staticClass:"flex-row-space-between"},[a("div",{staticClass:"flex-column-center"},[a("el-pagination",{attrs:{small:"",layout:"prev, next",total:e.total,"current-page":e.page,"page-size":10},on:{"current-change":e.currentChange}})],1),a("div",{staticClass:"flex-column-center"},[a("span",{staticStyle:{color:"#969ba4","line-height":"25px"}},[a("strong",{staticStyle:{color:"#38435a","font-weight":"400"}},[e._v(e._s(e.page))]),e._v("/"+e._s(Math.ceil(e.total/10))+" ")])]),a("div",{staticClass:"flex-column-center"},[a("el-button",{staticStyle:{color:"#5782db"},attrs:{type:"text"},on:{click:e.getTableData}},[e._v(" "+e._s(e.$t("views.vulnDetail.reload"))+" ")])],1)])]),e._l(e.tableData,(function(t){return a("div",{key:t.id,staticClass:"card",class:t.id===e.selectedId?e.cardRowClassName(!0,t.index):e.cardRowClassName(!1,t.index),attrs:{"track-by":"$index"},on:{click:function(a){return e.idChange(t.id)}}},[a("div",{staticClass:"titleLine"},[e._v(" "+e._s(t.uri+" "+e.$t("views.vulnDetail.has")+" "+t.type+" "+e.$t("views.vulnDetail.vuln"))+" ")]),a("div",{staticClass:"infoLine flex-row-space-between"},[a("span",{style:1===t.level_type?{color:"#EA7171"}:2===t.level_type?{color:"#F39D0A"}:3===t.level_type?{color:"#2E8FE9"}:4===t.level_type?{color:"#7BC1AB"}:""},[a("i",{staticClass:"iconfont iconweixian",staticStyle:{"font-size":"14px"}}),e._v(" "+e._s(t.level)+" ")]),a("span",[a("i",{staticClass:"iconfont iconshijian-2",staticStyle:{"font-size":"14px"}}),e._v(" "+e._s(t.latest_time)+" ")])])])}))],2)]),a("div",{staticClass:"operateCol",style:e.sliderWarpContract?{}:{"margin-left":"228px"}},[a("div",{staticStyle:{height:"100%"}},[a("i",{staticClass:"iconfont operateIcon",class:e.sliderWarpContract?"iconopen1-2":"iconopen11",on:{click:function(t){e.sliderWarpContract=!e.sliderWarpContract}}})])]),a("div",{staticClass:"vuln-warp",class:e.sliderWarpContract?"slider-warp-contract":"slider-warp-spreadOut"},[a("div",{staticClass:"vuln-title flex-row-space-between"},[a("div",{staticStyle:{flex:"1","max-width":"700px","word-break":"break-all"}},[e._v(" "+e._s(e.vulnObj.vul.url+" "+e.$t("views.vulnDetail.is")+e.vulnObj.vul.http_method+e.$t("views.vulnDetail.reqHas")+e.vulnObj.vul.type+e.$t("views.vulnDetail.vuln")+(e.vulnObj.vul.taint_position?","+e.$t("views.vulnDetail.position")+":"+e.vulnObj.vul.taint_position:""))+" ")]),a("div",{staticClass:"btnWarp"},[a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:e.recheckVul}},[a("i",{staticClass:"iconfont iconjiance-copy"}),e._v(" "+e._s(e.$t("views.vulnDetail.recheck"))+" ")]),a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:e.exportVul}},[a("i",{staticClass:"iconfont icondaochu-5"}),e._v(" "+e._s(e.$t("views.vulnDetail.export"))+" ")]),a("el-button",{staticClass:"btn",attrs:{type:"text"},on:{click:function(t){e.deleteDialogOpen=!0}}},[a("i",{staticClass:"iconfont iconshanchu-6"}),e._v(" "+e._s(e.$t("views.vulnDetail.delete"))+" ")])],1)]),a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.baseInfo"))+" ")]),a("div",{staticClass:"infoWarp"},[a("div",{staticClass:"infoLine flex-row-space-between"},[a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconfuwuqi-3"}),e._v(" "+e._s(e.$t("views.vulnDetail.serverIp"))+": ")]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.vulnObj.server.ip,placement:"top-start"}},[a("span",{staticClass:"dot"},[e._v(e._s(e.vulnObj.server.ip))])])],1),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconIp"}),e._v(" "+e._s(e.$t("views.vulnDetail.clientIp"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.client_ip))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconzhongjianjian"}),e._v(" "+e._s(e.$t("views.vulnDetail.middleware"))+": ")]),a("span",{staticStyle:{width:"140px",overflow:"hidden"}},[a("span",[e._v(e._s(e.vulnObj.server.container))])])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconyuyan-2"}),e._v(" "+e._s(e.$t("views.vulnDetail.language"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.language))])])]),a("div",{staticClass:"infoLine flex-row-space-between"},[a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconproject"}),e._v(" "+e._s(e.$t("views.vulnDetail.projectName"))+": ")]),a("span",{class:e.vulnObj.vul.project_id&&"project-name",on:{click:function(t){e.vulnObj.vul.project_id&&e.$router.push("/project/projectDetail/"+e.vulnObj.vul.project_id)}}},[e._v(e._s(e.vulnObj.vul.project_name))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconicon_details_banben"}),e._v(" "+e._s(e.$t("views.vulnDetail.version"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.project_version))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconshuju1"}),e._v(" "+e._s(e.$t("views.vulnDetail.taintParamName"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.param_name&&Object.values(e.vulnObj.vul.param_name).join(",")||e.$t("views.vulnDetail.empty")))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconloudong"}),e._v(" "+e._s(e.$t("views.vulnDetail.taintValue"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.taint_value||0))])])]),a("div",{staticClass:"infoLine flex-row-space-between"},[a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconshijian-3"}),e._v(" "+e._s(e.$t("views.vulnDetail.first_time"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.first_time))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconcishu-2"}),e._v(" "+e._s(e.$t("views.vulnDetail.counts"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.counts))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconweixian-2"}),e._v(" "+e._s(e.$t("views.vulnDetail.level"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.level))])]),a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info"},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconicon_yingyong_zhuagntai"}),e._v(" "+e._s(e.$t("views.vulnDetail.state"))+": ")]),a("el-select",{staticStyle:{width:"40%"},attrs:{placeholder:e.$t("views.vulnDetail.untreated"),size:"mini",filterable:"","allow-create":""},on:{change:e.changeStatus},model:{value:e.vulnObj.vul.status,callback:function(t){e.$set(e.vulnObj.vul,"status",t)},expression:"vulnObj.vul.status"}},e._l(e.statusOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),a("div",{staticClass:"infoLine flex-row-space-between"},[a("div",{directives:[{name:"dot",rawName:"v-dot"}],staticClass:"info",staticStyle:{flex:"2.5"}},[a("span",{staticClass:"label"},[a("i",{staticClass:"iconfont iconapp"}),e._v(" "+e._s(e.$t("views.vulnDetail.agent"))+": ")]),a("span",[e._v(e._s(e.vulnObj.vul.agent_name))])])])]),a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.vulnDesc"))+" ")]),a("div",{staticClass:"vulnDesc"},[e._v(" "+e._s(e.vulnObj.strategy.desc)+" ")]),e.vulnObj.vul.is_need_http_detail?[a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.httpRequest"))+" "),a("el-button",{staticStyle:{"margin-left":"8px",padding:"6px",background:"#4a72ae",color:"#fff"},attrs:{size:"mini"},on:{click:e.goToPoolDetail}},[a("i",{staticClass:"iconfont icongears",staticStyle:{"margin-right":"6px","font-size":"12px"}}),e._v(e._s(e.$t("views.vulnDetail.replay")))])],1),a("div",{staticClass:"selectForm"},[a("div",{staticClass:"select-item"}),e._l(e.httpOptions,(function(t){return a("div",{key:t.value,staticClass:"select-item",class:t.value===e.state&&"active",on:{click:function(a){e.state=t.value}}},[e._v(" "+e._s(t.label)+" ")])}))],2),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.state,expression:"state === 1"}],staticClass:"markdownContent httpRequest"},[a("MyMarkdownIt",{staticStyle:{color:"#747c8c"},attrs:{content:e.req_md}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.state,expression:"state === 0"}],staticClass:"markdownContent httpRequest"},[a("MyMarkdownIt",{staticStyle:{color:"#747c8c"},attrs:{content:e.res_md}})],1)]:e._e(),e.vulnObj.vul.graph&&e.vulnObj.vul.graph.length>0?a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.graph"))+" ")]):e._e(),e.vulnObj.vul.graph&&e.vulnObj.vul.graph.length>0?a("div",{staticClass:"graphModule flex-row-space-between"},[a("div",{staticClass:"left-warp"},[a("div",{staticClass:"flex-row-space-between dot-list"},[a("div",{staticClass:"tip"},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{color:"#5491ef"}}),a("span",[e._v(e._s(e.$t("views.vulnDetail.stainSource")))])]),a("div",{staticClass:"tip"},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{color:"#f3bc3f"}}),a("span",[e._v(e._s(e.$t("views.vulnDetail.communicationMethod")))])]),a("div",{staticClass:"tip"},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{color:"#ec984f"}}),a("span",[e._v(e._s(e.$t("views.vulnDetail.dangerMethod")))])])]),e._l(e.vulnObj.vul.graph,(function(t,i){return a("div",{key:i,staticClass:"vuln-pic"},[a("div",{staticClass:"flex-column-center",staticStyle:{padding:"0 5px"}},[a("i",{staticClass:"iconfont iconyuandianzhong",staticStyle:{color:"#ec984f"},style:0===i?{color:"#5491ef"}:i===e.vulnObj.vul.graph.length-1?{color:"#ec984f"}:{color:"#f3bc3f"}})]),a("div",{staticClass:"info"},[a("div",{staticClass:"nodeLine"},[a("div",{staticClass:"node"},[e._v(" "+e._s(t.node)+" ")])]),a("div",{staticClass:"nodeLine"},[a("div",{staticClass:"code"},[a("div",{directives:[{name:"dompurify-html",rawName:"v-dompurify-html",value:t.code,expression:"item.code"}]})]),a("div",{staticClass:"tag-list"},[t.tag?a("div",{staticClass:"tag"},[e._v(" "+e._s(t.tag)+" ")]):e._e(),a("el-tooltip",{staticClass:"item",attrs:{effect:"light",disabled:t.file.length<30,content:t.file,placement:"top"}},[a("div",{staticClass:"file"},[e._v("file: "+e._s(t.file))])]),a("div",{staticClass:"line"},[e._v("line:"+e._s(t.line_number))])],1)])])])}))],2)]):e._e(),e.vulnObj.strategy.repair_suggestion?a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.suggest"))+" ")]):e._e(),e.vulnObj.strategy.repair_suggestion?a("div",{staticClass:"markdownContent"},[a("MyMarkdownIt",{attrs:{content:e.vulnObj.strategy.repair_suggestion}})],1):e._e(),e.vulnObj.server.runtime?a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.devEnv"))+" ")]):e._e(),e.vulnObj.server.runtime?a("div",{staticClass:"baseInfo"},[a("div",{staticClass:"base-line",staticStyle:{padding:"10px 0px",height:"10px"}},[a("span",[e._v(e._s(e.vulnObj.server.runtime))])])]):e._e(),a("div",{staticClass:"module-title"},[e._v(" "+e._s(e.$t("views.vulnDetail.path"))+" ")]),a("div",{staticClass:"baseInfo"},[a("div",{staticClass:"base-line"},[a("span",{staticStyle:{color:"black","font-family":"PingFangSC-Medium, PingFang SC",display:"block"}},[e._v(" "+e._s(e.$t("views.vulnDetail.command"))+" ")]),a("span",{staticStyle:{display:"block","margin-top":"6px"}},[e._v(e._s(e.vulnObj.server.command))])]),e.vulnObj.server.environment?a("div",{staticClass:"base-line"},[a("span",{staticStyle:{color:"black","font-family":"PingFangSC-Medium, PingFang SC"}},[e._v(e._s(e.$t("views.vulnDetail.other")))])]):e._e(),e.vulnObj.server.environment?a("div",{staticClass:"base-line",staticStyle:{"padding-top":"6px"}},[a("span",{staticStyle:{color:"#849ed8"}},[e._v(e._s(e.vulnObj.server.environment)+" ")])]):e._e()])],2),a("el-dialog",{attrs:{visible:e.deleteDialogOpen,title:e.$t("views.vulnDetail.deleteVuln"),width:"25%"},on:{"update:visible":function(t){e.deleteDialogOpen=t}}},[a("div",{staticStyle:{"text-align":"center"}},[a("p",{staticStyle:{color:"#959fb4"}},[e._v(" "+e._s(e.$t("views.vulnDetail.deleteVulnInfo"))+" ")]),a("p",{staticStyle:{color:"#959fb4","margin-top":"14px"}},[e._v(" "+e._s(e.$t("views.vulnDetail.deleteVulnDesc"))+" ")])]),a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"confirmDel",attrs:{type:"text"},on:{click:e.vulnDelete}},[e._v(" "+e._s(e.$t("views.vulnDetail.deleteVulnEnter"))+" ")]),a("el-button",{staticClass:"cancelDel",attrs:{type:"text"},on:{click:function(t){e.deleteDialogOpen=!1}}},[e._v(" "+e._s(e.$t("views.vulnDetail.cancel"))+" ")])],1)])],1)},s=[],n=a("5530"),l=a("1da1"),r=a("d4ec"),o=a("bee2"),c=a("262e"),u=a("2caf"),v=(a("96cf"),a("d81d"),a("b0c0"),a("d3b7"),a("4d63"),a("c607"),a("ac1f"),a("2c3e"),a("25f0"),a("5319"),a("a15b"),a("1276"),a("159b"),a("99af"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("9ab4")),p=a("60a3"),d=a("73ec"),f=a("8c73"),h=a("b32d"),m=a("4328"),g=a.n(m),b=function(e){Object(c["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(r["a"])(this,a),e=t.apply(this,arguments),e.sliderWarpContract=!1,e.deleteDialogOpen=!1,e.statusOptions=[{value:e.$t("views.vulnDetail.reported"),label:e.$t("views.vulnDetail.reported")},{value:e.$t("views.vulnDetail.confirmed"),label:e.$t("views.vulnDetail.confirmed")},{value:e.$t("views.vulnDetail.fixed"),label:e.$t("views.vulnDetail.fixed")},{value:e.$t("views.vulnDetail.ignored"),label:e.$t("views.vulnDetail.ignored")}],e.state=1,e.httpOptions=[{value:1,label:e.$t("views.vulnDetail.req")},{value:0,label:e.$t("views.vulnDetail.res")}],e.vulnObj={vul:{url:"",uri:"",http_method:"",type:"",taint_position:"",first_time:0,latest_time:0,project_name:"",project_id:0,language:"",level:"",counts:0,req_header:"",graph:[],context_path:"",taint_value:"",param_name:""},server:{name:"",hostname:"",ip:"",port:0,container:"",container_path:"",runtime:"",environment:"",command:""},strategy:{desc:"",sample_code:"",repair_suggestion:""}},e.tableData=[],e.page=1,e.selectedId=0,e.total=0,e.cardIndex=0,e.searchObj={language:"",level:"",type:"",project_name:"",url:"",order:""},e.orderOptions=[{label:e.$t("views.vulnList.orderOptions.type"),value:"type"},{label:e.$t("views.vulnList.orderOptions.level"),value:"level"},{label:e.$t("views.vulnList.orderOptions.url"),value:"url"},{label:e.$t("views.vulnList.orderOptions.latest_time"),value:"latest_time"},{label:e.$t("views.vulnList.orderOptions.first_time"),value:"first_time"}],e.req_md="",e.res_md="",e}return Object(o["a"])(a,[{key:"getStatus",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.services.vuln.vulStatus();case 2:if(t=e.sent,201===t.status){e.next=6;break}return this.$message.error(t.msg),e.abrupt("return");case 6:this.statusOptions=t.data.map((function(e){return{value:e.name,label:e.name}}));case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.page=parseInt(this.$route.params.page),this.selectedId=parseInt(this.$route.params.id),this.cardIndex=0,e.next=5,this.getStatus();case 5:return e.next=7,this.getVulnDetail();case 7:return e.next=9,this.getTableData();case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"goToPoolDetail",value:function(){if(this.vulnObj.vul.method_pool_id){var e=this.$router.resolve({path:"/taint/poolDetail/".concat(this.vulnObj.vul.method_pool_id,"?activeName=flowDebug")}),t=e.href;window.open(t,"_blank")}else this.$message({showClose:!0,message:this.$t("views.vulnDetail.canNotReplay"),type:"error"})}},{key:"newSelectData",value:function(){this.page=1,this.getTableData()}},{key:"currentChange",value:function(e){this.page=e,this.getTableData()}},{key:"changeStatus",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.services.vuln.changeStatus({id:this.selectedId,status:t});case 2:a=e.sent,201===a.status?this.$message({type:"success",message:a.msg,showClose:!0}):this.$message({type:"error",message:a.msg,showClose:!0});case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTableData",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s,l,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={page:this.page,pageSize:10,language:this.searchObj.language,level:this.searchObj.level,type:this.searchObj.type,project_name:this.searchObj.project_name,url:this.searchObj.url,order:this.searchObj.order,status_id:this.$route.query.status},this.loadingStart(),e.next=4,this.services.vuln.vulnList(t);case 4:if(a=e.sent,i=a.status,s=a.data,l=a.page,r=a.msg,this.loadingDone(),201===i){e.next=13;break}return this.$message({type:"error",message:r,showClose:!0}),e.abrupt("return");case 13:this.tableData=s.reduce((function(e,t){return e.push(Object(n["a"])(Object(n["a"])({},t),{},{latest_time:Object(d["b"])(t.latest_time)})),e}),[]),this.total=l.alltotal;case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"idChange",value:function(e){this.selectedId=e,this.getVulnDetail()}},{key:"isJSON",value:function(e){if("string"==typeof e)try{return JSON.parse(e),!0}catch(t){return console.log(t),!1}}},{key:"getVulnDetail",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s,l=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.vuln.getVulnDetail(this.selectedId);case 3:if(t=e.sent,a=t.data,i=t.status,s=t.msg,this.loadingDone(),201===i){e.next=11;break}return this.$message({type:"error",message:s,showClose:!0}),e.abrupt("return");case 11:this.$nextTick((function(){function e(e,t){var a=new RegExp(t,"gi");return e.replace(a,(function(e){return"<tt style='color:red'>"+e+"</tt>"}))}var t=a.vul.req_header.split("<").join("&lt;").split("*").join("\\*"),i=t.split("\n");try{var s=function(t){switch(t){case"GET":var s=i[0].split(" "),n=s[1].split("?"),r=g.a.parse(n[1]),o=e(n[1],r[a.vul.param_name[t]]);n[1]=o,s[1]=n.join("?"),i[0]=s.join(" ");break;case"POST":if(l.isJSON(i[i.length-1])){var c=JSON.parse(i[i.length-1]),u=e(i[i.length-1],c[a.vul.param_name[t]]);i[i.length-1]=u}else{var v=g.a.parse(i[i.length-1]),p=e(i[i.length-1],v[a.vul.param_name[t]]);i[i.length-1]=p}break;case"COOKIE":i.forEach((function(s,n){if(s.indexOf("cookie:")>-1){var l=s.split(":"),r=g.a.parse(l[1]),o=e(l[1],r[a.vul.param_name[t]]);l[1]=o,i[n]=l.join(":")}}));break;case"PATH":var d=i[0].split("?"),f=e(d[0],a.vul.param_name[t]);d[0]=f,i[0]=d.join("?");break;case"HEADER":i.forEach((function(s,n){s.indexOf(a.vul.param_name[t])>-1&&(i[n]=e(s,s.split(":")[1]))}));break}};for(var r in a.vul.param_name)s(r)}catch(o){console.log(o)}l.req_md=i.join("<br/>"),l.res_md=a.vul.response.split("\n").join("<br/>"),l.vulnObj={vul:Object(n["a"])(Object(n["a"])({},a.vul),{},{first_time:Object(d["a"])(a.vul.first_time),latest_time:Object(d["a"])(a.vul.latest_time),graph:a.vul.graph}),server:Object(n["a"])({},a.server),strategy:Object(n["a"])({},a.strategy)}}));case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"vulnDelete",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingStart(),e.next=3,this.services.vuln.vulnDelete(this.selectedId);case 3:t=e.sent,a=t.status,i=t.msg,this.loadingDone(),201!==a?this.$message({type:"error",message:i,showClose:!0}):(this.$message({type:"success",message:i,showClose:!0}),this.$router.push("/vuln/vulnList"));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"tableRowClassName",value:function(){return"diy-row"}},{key:"cardRowClassName",value:function(e,t){var a="";return e?a="selected":t%2===0&&(a="card-gap"),a}},{key:"exportVul",value:function(){var e=this,t=this.vulnObj.vul.project_name;h["a"].get("project/export?vid=".concat(this.selectedId,"&pid=").concat(this.vulnObj.vul.project_id),{responseType:"blob"}).then((function(a){if("application/json"===a.type)e.$message.error({message:e.$t("views.vulnDetail.exportFail"),showClose:!0});else{var i=new Blob([a],{type:"application/octet-stream"}),s=document.createElement("a");s.href=window.URL.createObjectURL(i),s.download=t+".doc",s.click(),e.$message.success({message:e.$t("views.vulnDetail.exportSuccess"),showClose:!0})}})).catch((function(){e.$message.error({message:e.$t("views.vulnDetail.exportFail"),showClose:!0})}))}},{key:"recheckVul",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={ids:this.selectedId.toString()},e.next=3,this.services.vuln.vulRecheck(t);case 3:a=e.sent,i=a.status,s=a.msg,201!==i?this.$message({type:"error",message:s,showClose:!0}):this.$message({type:"success",message:s,showClose:!0});case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),a}(f["a"]);b=Object(v["b"])([Object(p["a"])({name:"VulnDetail"})],b);var y=b,_=y,w=(a("a426"),a("9b3c"),a("2877")),C=Object(w["a"])(_,i,s,!1,null,"58f26d45",null);t["default"]=C.exports},"3cde":function(e,t,a){},4127:function(e,t,a){"use strict";var i=a("d233"),s=a("b313"),n={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},l=Array.isArray,r=Array.prototype.push,o=function(e,t){r.apply(e,l(t)?t:[t])},c=Date.prototype.toISOString,u={delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,serializeDate:function(e){return c.call(e)},skipNulls:!1,strictNullHandling:!1},v=function e(t,a,s,n,r,c,v,p,d,f,h,m){var g=t;if("function"===typeof v?g=v(a,g):g instanceof Date&&(g=f(g)),null===g){if(n)return c&&!m?c(a,u.encoder):a;g=""}if("string"===typeof g||"number"===typeof g||"boolean"===typeof g||i.isBuffer(g)){if(c){var b=m?a:c(a,u.encoder);return[h(b)+"="+h(c(g,u.encoder))]}return[h(a)+"="+h(String(g))]}var y,_=[];if("undefined"===typeof g)return _;if(l(v))y=v;else{var w=Object.keys(g);y=p?w.sort(p):w}for(var C=0;C<y.length;++C){var j=y[C];r&&null===g[j]||(l(g)?o(_,e(g[j],s(a,j),s,n,r,c,v,p,d,f,h,m)):o(_,e(g[j],a+(d?"."+j:"["+j+"]"),s,n,r,c,v,p,d,f,h,m)))}return _};e.exports=function(e,t){var a=e,r=t?i.assign({},t):{};if(null!==r.encoder&&"undefined"!==typeof r.encoder&&"function"!==typeof r.encoder)throw new TypeError("Encoder has to be a function.");var c="undefined"===typeof r.delimiter?u.delimiter:r.delimiter,p="boolean"===typeof r.strictNullHandling?r.strictNullHandling:u.strictNullHandling,d="boolean"===typeof r.skipNulls?r.skipNulls:u.skipNulls,f="boolean"===typeof r.encode?r.encode:u.encode,h="function"===typeof r.encoder?r.encoder:u.encoder,m="function"===typeof r.sort?r.sort:null,g="undefined"!==typeof r.allowDots&&r.allowDots,b="function"===typeof r.serializeDate?r.serializeDate:u.serializeDate,y="boolean"===typeof r.encodeValuesOnly?r.encodeValuesOnly:u.encodeValuesOnly;if("undefined"===typeof r.format)r.format=s["default"];else if(!Object.prototype.hasOwnProperty.call(s.formatters,r.format))throw new TypeError("Unknown format option provided.");var _,w,C=s.formatters[r.format];"function"===typeof r.filter?(w=r.filter,a=w("",a)):l(r.filter)&&(w=r.filter,_=w);var j,O=[];if("object"!==typeof a||null===a)return"";j=r.arrayFormat in n?r.arrayFormat:"indices"in r?r.indices?"indices":"repeat":"indices";var x=n[j];_||(_=Object.keys(a)),m&&_.sort(m);for(var D=0;D<_.length;++D){var $=_[D];d&&null===a[$]||o(O,v(a[$],$,x,p,d,f?h:null,w,m,g,b,C,y))}var k=O.join(c),S=!0===r.addQueryPrefix?"?":"";return k.length>0?S+k:""}},4328:function(e,t,a){"use strict";var i=a("4127"),s=a("9e6a"),n=a("b313");e.exports={formats:n,parse:s,stringify:i}},"7d25":function(e,t,a){},"9b3c":function(e,t,a){"use strict";a("7d25")},"9e6a":function(e,t,a){"use strict";var i=a("d233"),s=Object.prototype.hasOwnProperty,n={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:i.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},l=function(e,t){for(var a={},i=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,l=t.parameterLimit===1/0?void 0:t.parameterLimit,r=i.split(t.delimiter,l),o=0;o<r.length;++o){var c,u,v=r[o],p=v.indexOf("]="),d=-1===p?v.indexOf("="):p+1;-1===d?(c=t.decoder(v,n.decoder),u=t.strictNullHandling?null:""):(c=t.decoder(v.slice(0,d),n.decoder),u=t.decoder(v.slice(d+1),n.decoder)),s.call(a,c)?a[c]=[].concat(a[c]).concat(u):a[c]=u}return a},r=function(e,t,a){for(var i=t,s=e.length-1;s>=0;--s){var n,l=e[s];if("[]"===l&&a.parseArrays)n=[].concat(i);else{n=a.plainObjects?Object.create(null):{};var r="["===l.charAt(0)&&"]"===l.charAt(l.length-1)?l.slice(1,-1):l,o=parseInt(r,10);a.parseArrays||""!==r?!isNaN(o)&&l!==r&&String(o)===r&&o>=0&&a.parseArrays&&o<=a.arrayLimit?(n=[],n[o]=i):"__proto__"!==r&&(n[r]=i):n={0:i}}i=n}return i},o=function(e,t,a){if(e){var i=a.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,n=/(\[[^[\]]*])/,l=/(\[[^[\]]*])/g,o=n.exec(i),c=o?i.slice(0,o.index):i,u=[];if(c){if(!a.plainObjects&&s.call(Object.prototype,c)&&!a.allowPrototypes)return;u.push(c)}var v=0;while(null!==(o=l.exec(i))&&v<a.depth){if(v+=1,!a.plainObjects&&s.call(Object.prototype,o[1].slice(1,-1))&&!a.allowPrototypes)return;u.push(o[1])}return o&&u.push("["+i.slice(o.index)+"]"),r(u,t,a)}};e.exports=function(e,t){var a=t?i.assign({},t):{};if(null!==a.decoder&&void 0!==a.decoder&&"function"!==typeof a.decoder)throw new TypeError("Decoder has to be a function.");if(a.ignoreQueryPrefix=!0===a.ignoreQueryPrefix,a.delimiter="string"===typeof a.delimiter||i.isRegExp(a.delimiter)?a.delimiter:n.delimiter,a.depth="number"===typeof a.depth?a.depth:n.depth,a.arrayLimit="number"===typeof a.arrayLimit?a.arrayLimit:n.arrayLimit,a.parseArrays=!1!==a.parseArrays,a.decoder="function"===typeof a.decoder?a.decoder:n.decoder,a.allowDots="boolean"===typeof a.allowDots?a.allowDots:n.allowDots,a.plainObjects="boolean"===typeof a.plainObjects?a.plainObjects:n.plainObjects,a.allowPrototypes="boolean"===typeof a.allowPrototypes?a.allowPrototypes:n.allowPrototypes,a.parameterLimit="number"===typeof a.parameterLimit?a.parameterLimit:n.parameterLimit,a.strictNullHandling="boolean"===typeof a.strictNullHandling?a.strictNullHandling:n.strictNullHandling,""===e||null===e||"undefined"===typeof e)return a.plainObjects?Object.create(null):{};for(var s="string"===typeof e?l(e,a):e,r=a.plainObjects?Object.create(null):{},c=Object.keys(s),u=0;u<c.length;++u){var v=c[u],p=o(v,s[v],a);r=i.merge(r,p,a)}return i.compact(r)}},a15b:function(e,t,a){"use strict";var i=a("23e7"),s=a("e330"),n=a("44ad"),l=a("fc6a"),r=a("a640"),o=s([].join),c=n!=Object,u=r("join",",");i({target:"Array",proto:!0,forced:c||!u},{join:function(e){return o(l(this),void 0===e?",":e)}})},a426:function(e,t,a){"use strict";a("3cde")},b313:function(e,t,a){"use strict";var i=String.prototype.replace,s=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return i.call(e,s,"+")},RFC3986:function(e){return String(e)}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},d233:function(e,t,a){"use strict";var i=Object.prototype.hasOwnProperty,s=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),n=function(e){var t;while(e.length){var a=e.pop();if(t=a.obj[a.prop],Array.isArray(t)){for(var i=[],s=0;s<t.length;++s)"undefined"!==typeof t[s]&&i.push(t[s]);a.obj[a.prop]=i}}return t},l=function(e,t){for(var a=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)"undefined"!==typeof e[i]&&(a[i]=e[i]);return a},r=function e(t,a,s){if(!a)return t;if("object"!==typeof a){if(Array.isArray(t))t.push(a);else{if(!t||"object"!==typeof t)return[t,a];(s&&(s.plainObjects||s.allowPrototypes)||!i.call(Object.prototype,a))&&(t[a]=!0)}return t}if(!t||"object"!==typeof t)return[t].concat(a);var n=t;return Array.isArray(t)&&!Array.isArray(a)&&(n=l(t,s)),Array.isArray(t)&&Array.isArray(a)?(a.forEach((function(a,n){if(i.call(t,n)){var l=t[n];l&&"object"===typeof l&&a&&"object"===typeof a?t[n]=e(l,a,s):t.push(a)}else t[n]=a})),t):Object.keys(a).reduce((function(t,n){var l=a[n];return i.call(t,n)?t[n]=e(t[n],l,s):t[n]=l,t}),n)},o=function(e,t){return Object.keys(t).reduce((function(e,a){return e[a]=t[a],e}),e)},c=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},u=function(e){if(0===e.length)return e;for(var t="string"===typeof e?e:String(e),a="",i=0;i<t.length;++i){var n=t.charCodeAt(i);45===n||46===n||95===n||126===n||n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122?a+=t.charAt(i):n<128?a+=s[n]:n<2048?a+=s[192|n>>6]+s[128|63&n]:n<55296||n>=57344?a+=s[224|n>>12]+s[128|n>>6&63]+s[128|63&n]:(i+=1,n=65536+((1023&n)<<10|1023&t.charCodeAt(i)),a+=s[240|n>>18]+s[128|n>>12&63]+s[128|n>>6&63]+s[128|63&n])}return a},v=function(e){for(var t=[{obj:{o:e},prop:"o"}],a=[],i=0;i<t.length;++i)for(var s=t[i],l=s.obj[s.prop],r=Object.keys(l),o=0;o<r.length;++o){var c=r[o],u=l[c];"object"===typeof u&&null!==u&&-1===a.indexOf(u)&&(t.push({obj:l,prop:c}),a.push(u))}return n(t)},p=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},d=function(e){return null!==e&&"undefined"!==typeof e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))};e.exports={arrayToObject:l,assign:o,compact:v,decode:c,encode:u,isBuffer:d,isRegExp:p,merge:r}}}]);
//# sourceMappingURL=chunk-5ec25e6a.e4fdd2b1.js.map